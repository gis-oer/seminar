<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>gis_exercises_ut</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded "><a href="index.html"><strong aria-hidden="true">1.</strong> 本実習について</a></li><li class="expanded "><a href="day1/index.html"><strong aria-hidden="true">2.</strong> Day 1</a></li><li><ol class="section"><li class="expanded "><a href="day1/qgis.html"><strong aria-hidden="true">2.1.</strong> QGIS入門</a></li><li class="expanded "><a href="day1/tasks/t_qgis_entry.html"><strong aria-hidden="true">2.2.</strong> 課題①</a></li><li class="expanded "><a href="day1/07.html"><strong aria-hidden="true">2.3.</strong> データダウンロード</a></li><li class="expanded "><a href="day1/tasks/t_07.html"><strong aria-hidden="true">2.4.</strong> 課題②</a></li><li class="expanded "><a href="day1/12.html"><strong aria-hidden="true">2.5.</strong> ネットワーク分析</a></li><li class="expanded "><a href="day1/tasks/t_12.html"><strong aria-hidden="true">2.6.</strong> 課題③</a></li></ol></li><li class="expanded "><a href="day2/index.html"><strong aria-hidden="true">3.</strong> Day 2</a></li><li><ol class="section"><li class="expanded "><a href="day2/08.html"><strong aria-hidden="true">3.1.</strong> 空間座標系の変換</a></li><li class="expanded "><a href="day2/tasks/t_08.html"><strong aria-hidden="true">3.2.</strong> 課題①</a></li><li class="expanded "><a href="day2/11.html"><strong aria-hidden="true">3.3.</strong> 基本的な空間解析</a></li><li class="expanded "><a href="day2/tasks/t_11.html"><strong aria-hidden="true">3.4.</strong> 課題②〜③</a></li><li class="expanded "><a href="day2/13.html"><strong aria-hidden="true">3.5.</strong> 領域分析（バッファ）</a></li><li class="expanded "><a href="day2/tasks/t_13.html"><strong aria-hidden="true">3.6.</strong> 課題④</a></li><li class="expanded "><a href="day2/14.html"><strong aria-hidden="true">3.7.</strong> 点データの分析</a></li><li class="expanded "><a href="day2/tasks/t_14.html"><strong aria-hidden="true">3.8.</strong> 課題⑤</a></li></ol></li><li class="expanded "><a href="day3/index.html"><strong aria-hidden="true">4.</strong> Day 3</a></li><li><ol class="section"><li class="expanded "><a href="day3/10.html"><strong aria-hidden="true">4.1.</strong> 空間データの作成</a></li><li class="expanded "><a href="day3/tasks/t_10.html"><strong aria-hidden="true">4.2.</strong> 課題①</a></li><li class="expanded "><a href="day3/15.html"><strong aria-hidden="true">4.3.</strong> 地形情報の可視化、流域解析</a></li><li class="expanded "><a href="day3/tasks/t_15.html"><strong aria-hidden="true">4.4.</strong> 課題②〜③</a></li><li class="expanded "><a href="day3/18.html"><strong aria-hidden="true">4.5.</strong> 空間補間</a></li><li class="expanded "><a href="day3/tasks/t_18.html"><strong aria-hidden="true">4.6.</strong> 課題④〜⑤</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">gis_exercises_ut</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回" id="2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回">2019年度　地球惑星環境科学科リモートセンシング・ GISおよび実習 （GIS回）</a></h1>
<h2><a class="header" href="#日程-202025-6-7" id="日程-202025-6-7">日程　2020/2/5, 6, 7</a></h2>
<ul>
<li>講義:10:00-12:00</li>
<li>実習:13:00-17:00</li>
</ul>
<h2><a class="header" href="#実習について" id="実習について">実習について</a></h2>
<ul>
<li>
<p>実習は、冒頭で概要と課題の簡単な説明をした後に、受講者が教材を参考に学習を進める形式で行います。実習ごとに、オンライン教材（<a href="https://gis-oer.github.io/gitbook/book/">GIS実習オープン教材</a>）を用いて学習した後、指定された課題を行てください。</p>
</li>
<li>
<p>課題は、実習と対応した <strong>地図の作成と設問</strong> への回答です。1回の実習で3～5枚程度の地図の作成と提出が必要です。課題として作成した地図画像は、ファイルにまとめて<code>右クリック＞圧縮し、zipファイルにしたものをアンケートフォームより提出してください</code>。</p>
</li>
<li>
<p>実習終了後、アンケートに回答してください。このアンケートの結果は、個人が特定できないように加工した後に、学習効果の評価や教材の改良等に利用します。課題の提出もアンケートフォームから行います。アンケートは、Googleフォームを利用するので、Googleアカウント（東大のメールアカウントに紐付けられたもの）を準備してください。</p>
</li>
<li>
<p>初回の実習以外は、<strong>空間座標を適切に変換した後、実習、課題の作成を行ってください</strong>。</p>
</li>
<li>
<p>各実習の詳細は、使用するデータとともに、各実習日に公開します。</p>
</li>
<li>
<p>実習を行う際には、以下の注意事項を確認したうえで、進めてください。</p>
</li>
</ul>
<h3><a class="header" href="#実習の注意事項" id="実習の注意事項">実習の注意事項</a></h3>
<ul>
<li>ファイル名、出力先などに日本語が含まれているとエラーが起きる場合があります。</li>
<li>デフォルトの設定（ディレクトリ）でデータを出力するとエラーが起きます。</li>
<li>shapeファイルは、.shp,.shx,.dbf等の複数のファイルから構成されます。そのため、移動する際にはすべてを移動してください。.shpのみを移動したために、データが表示できないというミスが多いです。</li>
<li>初回の実習のみ、空間座標系の関係上、各教材や課題の終了後にQGISを一度閉じ（作業ファイルは任意の場所に保存）、再起動してから次の実習、課題を行ってください。</li>
</ul>
<h1><a class="header" href="#2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-1" id="2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-1">2019年度　地球惑星環境科学科リモートセンシング・ GISおよび実習 （GIS回）</a></h1>
<h2><a class="header" href="#25水gis入門" id="25水gis入門">2/5(水)：GIS入門</a></h2>
<ol>
<li>QGIS入門</li>
<li>既存データの取得と変換</li>
<li>ネットワーク分析(最短経路検索)</li>
</ol>
<p><a href="https://drive.google.com/open?id=1h1mr14BHxV7K_XWZEky3IWejP38tzVcqPeVPwei3Oq0">Day 1 課題提出フォーム</a></p>
<h3><a class="header" href="#実習の注意事項-1" id="実習の注意事項-1">実習の注意事項</a></h3>
<ul>
<li>ファイル名、出力先などに日本語が含まれているとエラーが起きる場合があります。</li>
<li>デフォルトの設定（ディレクトリ）でデータを出力するとエラーが起きます。</li>
<li>shapeファイルは、.shp,.shx,.dbf等の複数のファイルから構成されます。そのため、移動する際にはすべてを移動してください。.shpのみを移動したために、データが表示できないというミスが多いです。</li>
<li>初回の実習のみ、空間座標系の関係上、各教材や課題の終了後にQGISを一度閉じ（作業ファイルは任意の場所に保存）、再起動してから次の実習、課題を行ってください。</li>
</ul>
<h1><a class="header" href="#qgisビギナーズマニュアル" id="qgisビギナーズマニュアル">QGISビギナーズマニュアル</a></h1>
<p>　本教材は、QGIS入門者向けの実習用教材です。QGISを実際に操作しながら、空間データの表示、シンボルの変更、地図のレイアウト等を学習することができます。</p>
<h2><a class="header" href="#menu" id="menu"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day1/qgis.html#qgis%E3%81%A8%E3%81%AF%EF%BC%9F">QGISとは？</a></li>
<li><a href="day1/qgis.html#%E8%B5%B7%E5%8B%95">起動</a></li>
<li><a href="day1/qgis.html#%E3%82%A6%E3%82%A4%E3%83%B3%E3%83%89%E3%82%A6">ウインドウ</a></li>
<li><a href="day1/qgis.html#%E5%90%84%E7%A8%AE%E3%83%9C%E3%82%BF%E3%83%B3">各種ボタン</a></li>
<li><a href="day1/qgis.html#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">データの読み込み</a></li>
<li><a href="day1/qgis.html#%E6%A9%9F%E8%83%BD%E8%AA%AC%E6%98%8E">機能説明</a></li>
<li><a href="day1/qgis.html#%E5%B1%9E%E6%80%A7%E3%83%86%E3%83%BC%E3%83%96%E3%83%AB">属性テーブル</a></li>
<li><a href="day1/qgis.html#%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3">プロパティ</a></li>
<li><a href="day1/qgis.html#%E5%9C%B0%E5%9B%B3%E3%82%BF%E3%82%A4%E3%83%AB%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF">地図タイルの読み込み</a></li>
<li><a href="day1/qgis.html#%E5%9C%B0%E5%9B%B3%E3%81%AE%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88">地図のレイアウト</a></li>
<li><a href="day1/qgis.html#%E4%BD%9C%E6%A5%AD%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E4%BF%9D%E5%AD%98">作業ファイルの保存</a></li>
<li><a href="day1/qgis.html#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3">プラグイン</a></li>
<li><a href="day1/qgis.html#%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E4%BF%9D%E5%AD%98%E5%BD%A2%E5%BC%8F">データの保存形式</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/tokyo.zip">tokyo.zip</a>をダウンロードしてください。</p>
<h2><a class="header" href="#qgisとは" id="qgisとは">QGISとは？</a></h2>
<p>　QGISは、無償で利用できるオープンソース（GNU General Public License v2で提供）のGISです。Windows,Mac,Linux,Unix, Androidなど様々な環境で動作します。様々なプラグインや、GRASSやPostGISなど他のオープンソースGISと連携して使用することで、多種類の分析が可能です。GISの基本操作に必要な機能を網羅しているだけでなく、Web上に多数のマニュアルがアップロードされているため、GISの学習がしやすいソフトウェアです。  </p>
<blockquote>
<p>http://qgis.org/ja/site/about/index.html を参考に作成</p>
</blockquote>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#起動" id="起動">起動</a></h2>
<p>　デスクトップのQGISアイコンをダブルクリックする。しばらくするとQGISが起動する。
<img src="day1/pic/Qpic5.png" alt="起動" /></p>
<p>最初にQGIS3を起動した時には、下記の様に古いバージョンのGIS2からの設定を取り込むか聞かれることがある。この演習ではQGIS2とは関係なくQGIS3を利用するため、「QGIS 2の設定をインポートせずクリーンな状態でスタートする」を選択する。この設定は最初の1回のみで済む。
<img src="day1/pic/first_question.jpg" alt="起動" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#ウインドウ" id="ウインドウ">ウインドウ</a></h2>
<p>　QGISを起動すると、下の図のようなウィンドウが表示されます。ウインドウ上のアイコンの配置は自由に変更することができます。アイコンのない箇所（グレーの部分）で右クリックして出てくる「パネル」メニューからパネルを選択することにより、別機能のパネルを呼び出すことができます。アイコンの数は、インストールしているプラグインの数によっても異なります。そのため、インストール直後のQGISと教材の画像が異なっていることを確認してください。
<img src="day1/pic/Qpic6.png" alt="ウインドウ" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#各種ボタン" id="各種ボタン">各種ボタン</a></h2>
<p>　以下では、QGISで主に使用するボタンについて解説しています。</p>
<p><img src="day1/pic/Qpic7.png" alt="ボタンA" /></p>
<ol>
<li>QGISファイルを保存</li>
<li>名前をつけてQGISファイルを保存</li>
<li>地図移動</li>
<li>地図の拡大と縮小</li>
<li>選択領域にズーム</li>
<li>動作の前後移動</li>
<li>地物情報の表示</li>
<li>選択と選択取り消し</li>
<li>長さ、面積計測（手動）</li>
<li>レイヤ編集</li>
<li>レイヤの読み込み</li>
</ol>
<p>また、ウィンドウの下部にはカーソルの座標や縮尺、拡大、回転、座標系などを確認できるツールバーがあります。</p>
<p><img src="day1/pic/Qpic8.png" alt="ボタンB" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#データの読み込み" id="データの読み込み">データの読み込み</a></h2>
<p>　GISでは、位置情報を保持するベクトルデータとラスタデータを用いて、空間分析等を行います。各データの特徴は、<a href="day1/../00/00.html">GISの基本概念_ベクトルデータとラスタデータ</a>を参照してください。以下では、代表的なデータ形式を取り上げ、それらをQGISで読み込む手法について解説します。教材中に記載されている使用データ(<a href="https://github.com/gis-oer/datasets/raw/master/tokyo.zip">tokyo.zip</a>)を用意してください。そして、tokyo.zipファイルをダウンロード後に解凍してください）。</p>
<h3><a class="header" href="#ベクトルデータ読み込み" id="ベクトルデータ読み込み">ベクトルデータ読み込み</a></h3>
<p>以下では、GISで扱う代表的なベクトルデータ形式のシェープファイルを読み込む手法について解説する。シェープファイルの特徴は、<a href="day1/../00/00.html">GISの基本概念_シェープファイル</a>を参照してください。</p>
<p><code>データソースマネージャーを開く</code>のアイコンをクリックし、<code>ベクタ</code>のタブに切り替える。エンコーディングをUTF-8とし、ソースから、cvs_jgd2011_9.shpを指定する。<code>追加</code>をクリックするとデータが表示される。
<img src="day1/pic/Qpic9.png" alt="ベクタ" /></p>
<p><img src="day1/pic/Qpic10.png" alt="ベクタ" /></p>
<p>上記のように、cvs_jgd2011_9.shpを読み込むと、東京23区内のコンビニが表示される（ポイントデータ）。ベクトルデータには、ポイント、ライン、ポリゴンのデータ形式がある。ラインとポリゴンも同様の手法で読み込むことができる。</p>
<h4><a class="header" href="#ライン" id="ライン">ライン</a></h4>
<p>東京周辺の河川(river_9kei.shp)を表示する。
<img src="day1/pic/Qpic11.png" alt="ベクタ" /></p>
<h4><a class="header" href="#ポリゴン" id="ポリゴン">ポリゴン</a></h4>
<p>東京23区のエリア(tokyo_23ku_jgd2011_9.shp)を表示する。
<img src="day1/pic/Qpic12.png" alt="ベクタ" /></p>
<p>【註】ここまで続けてベクトルデータを読み込むと、ポイントの上にラインが被さり、さらにポリゴンのデータが被さって表示されます。これはレイヤーで後から読み込んだものが、一番上に表示されるためです。3つのデータがうまく表示されるように、レイヤーパネルでレイヤー名をドラッグしてレイヤー順番を変えます。委細については、後の「レイヤ構造」で説明します。</p>
<h3><a class="header" href="#ラスタデータの読み込み" id="ラスタデータの読み込み">ラスタデータの読み込み</a></h3>
<p>以下では、GISで扱う代表的なラスタデータ形式のGeotiffを読み込む手法について解説する。<code>データソースマネージャーを開く</code>のアイコンをクリックし、<code>ラスタ</code>のタブに切り替える。ソースから、tokyo_srtm.tifを指定し追加をクリックする。
<img src="day1/pic/Qpic13.png" alt="ラスタ" /></p>
<p><img src="day1/pic/Qpic14.png" alt="ラスタ" /></p>
<h4><a class="header" href="#テキストデータ読み込み" id="テキストデータ読み込み">テキストデータ読み込み</a></h4>
<p>以下では、GISで扱う代表的なテキストファイルであるCSV形式のデータを読み込む手法について解説する。<code>データソースマネージャーを開く</code>のアイコンをクリックし、<code>デリミティッドテキスト</code>のタブに切り替える。ファイル名から、post_office.csvを指定する。X,Yフィールドに対応する緯度経度があれば指定し、緯度経度がなければジオメトリなしにチェックをする(ここでは、<code>ジオメトリ定義＞ジオメトリなし</code>にチェックを入れてください。)。
<img src="day1/pic/Qpic15.png" alt="CSV" /></p>
<p>【註】本実習のCSVファイルはUTF-8エンコーディングで作成されています。GGIS3のデフォルトでのエンコーディング（レイヤ名の横で指定できます）はUTF-8になっていますのでこのままで結構です。ただ、Windowsで作成されるCSVファイルはShift-JIS形式で作成されていることが多いので、その場合はエンコーディング形式を「Shift-JIS」に選択する必要があります。エンコーディングが正しく設定されているかは、サンプルデータの表示が適切になされていることで確認することができます。</p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#レイヤ構造" id="レイヤ構造">レイヤ構造</a></h2>
<p>　GISでは、レイヤ構造に従ってデータの切り替えや重ね合わせを行います。以下では、レイヤの切り替え、重ね合わせ、削除の手法を解説します。</p>
<h3><a class="header" href="#レイヤ表示の切替" id="レイヤ表示の切替">レイヤ表示の切替</a></h3>
<p>各レイヤの横にあるチェックボックスにチェックをいれると、地図表示画面にレイヤが表示される。
<img src="day1/pic/Qpic16.png" alt="CSV" /></p>
<h3><a class="header" href="#レイヤの重ね合わせ" id="レイヤの重ね合わせ">レイヤの重ね合わせ</a></h3>
<p>レイヤウィンドウでレイヤを上下にずらすと、地図表示画面が連動して切り替わる。
<img src="day1/pic/Qpic17.png" alt="CSV" /></p>
<h3><a class="header" href="#レイヤの削除" id="レイヤの削除">レイヤの削除</a></h3>
<p>レイヤウィンドウでレイヤの上で右クリックし、<code>レイヤの削除</code>をクリックする。この処理では、レイヤウィンドウ上からレイヤが消えるのみで、データそのものは削除されていない点に注意する。
<img src="day1/pic/Qpic18.png" alt="CSV" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#機能説明" id="機能説明">機能説明</a></h2>
<p>　QGISには、地図のレイアウト、データの作成、分析など様々な機能があります。以下では、QGISの機能について説明しています。</p>
<p><img src="day1/pic/Qpic19.png" alt="機能説明a" />
プロジェクト：QGIS（.qgs）ファイルの保存や読み込み、地図のレイアウト、エクスポートができる。</p>
<p>編集：ベクタレイヤの編集ができる。編集状態になると、アクティブになる。</p>
<p><img src="day1/pic/Qpic20.png" alt="機能説明b" />
ビュー：地図の移動や拡大、縮小など、地図画面の操作ができる。</p>
<p>レイヤ：ベクタやラスタなどのレイヤが追加できる。</p>
<p>ポイント、ライン、ポリゴン新規レイヤの作成もできる。</p>
<p><img src="day1/pic/Qpic21.png" alt="機能説明c" />
設定：オプションから、プロジェクトの設定やスナップオプションが設定できる。</p>
<p>プラグイン：プラグインの管理とインストールができる。Python入力画面が開ける。</p>
<p><img src="day1/pic/Qpic22.png" alt="機能説明d" />
ベクタ：バッファやクリップなどベクタに関する処理ができる。</p>
<p>ラスタ：斜面方位図や陰影図の作成などラスタに関する処理ができる。</p>
<p><img src="day1/pic/Qpic23.png" alt="機能説明e" />
データベース：PostGISなどのデータベースへの接続やeVisプラグインによる外部ファイルとの連携が可能。</p>
<p>Web：背景地図の設定やweb地図の書き出しができる（プラグインによる）。</p>
<p><img src="day1/pic/Qpic24.png" alt="機能説明f" />
プロッセッシング：他のGISソフトウェアと連携して操作ができる（R,GRASS,SAGAなどがQGIS内で処理できる）。</p>
<p>ヘルプ：QGISのヘルプが確認できる。</p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#属性テーブル" id="属性テーブル">属性テーブル</a></h2>
<p>　ベクトルデータは、複数の属性情報を保持することができます。以下では、QGISで属性情報を参照する手法について、解説しています。</p>
<p><strong>以下では、cvs_jgd2011_9.shpのみ利用します。不要なレイヤを削除してください。</strong></p>
<p>データを読み込み、レイヤウィンドウのレイヤの上で右クリックすると、属性テーブルを開くことができる。
<img src="day1/pic/Qpic25.png" alt="属性テーブルa" /></p>
<p>属性テーブルで選択したものは、地図上で黄色で表示される。選択アイコンで地図上の地物を選択した場合は、その地物に対応する属性テーブルの行が選択される。
地図上の地物を選択した時に、そのままでは属性テーブルの中で全てのデータが表示され、選択したものがわかりにくい時がある。その時には属性テーブルの下部にあるポップアップメニューから「選択した地物を表示する」を選択し、選択された地物に関する属性だけが表示されるようにすることで見やすくなります。
なお、ポリゴンによる選択（選択ボタンの右側にある小さな三角を押すとポップアップメニューが表示され、ポリゴン、フリーハンド等が選択できます）は、右クリックで終了し、フリーハンドによる選択は左クリックで終了と、操作性に一貫がなく分かりにくい状態です。</p>
<p><img src="day1/pic/Qpic26.png" alt="属性テーブルb" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#プロパティ" id="プロパティ">プロパティ</a></h2>
<p>　QGISでは、レイヤごとにレイヤのプロパティから、データの表示情報やスタイルの変更ができます。ポイントでは形や大きさ、ラインでは線の形や太さ、ポリゴンでは塗りつぶしの色等を変更することができます。属性情報に応じて、スタイルを分けることもできます。これは、レイヤの表示が変化するのみの処理で、データそのものの形状は変更されません。</p>
<p>以下では、レイヤのプロパティについて解説し、ポイントデータのスタイルの変更を行います。</p>
<p>レイヤウインドウからプロパティを表示したいレイヤを選択し、右クリックからプロパティをクリックする。
<img src="day1/pic/Qpic27.png" alt="プロパティ" /></p>
<h3><a class="header" href="#ソース" id="ソース">ソース</a></h3>
<p>座標系を確認したり、文字コード、表示名の変更がきます。
<img src="day1/pic/Qpic28.png" alt="一般情報" /></p>
<h3><a class="header" href="#シンボロジー" id="シンボロジー">シンボロジー</a></h3>
<p>データのスタイルを整えることができる機能です。データの値に応じて配色やスタイルを変えることができます。分類方法は「単一シンボル」、「分類された」、「段階に分けられた」等があります。</p>
<p>ここでは、ポイントデータの大きさと色を変更します。<code>単一シンボル</code>を選択し、色と大きさを指定する。指定できた状態で<code>OK</code>をクリックすると変更が適用される。
<img src="day1/pic/Qpic29.png" alt="スタイルa" /></p>
<p>以下のように、形を変更することもできる。
<img src="day1/pic/Qpic30.png" alt="スタイルb" /></p>
<p>属性テーブルの値によって、大きさと色を変更するには、シンボロジーの画面の一番上にあるポップアップメニューにおいて、<code>分類された</code>を選択し、分類したいフィールドを選択する。</p>
<p>ここではコンビニごとに色を変更するため、「カラム」フィールドのポップアップメニューから<code>name_en</code>を選択する。この状態で、左下の「分類」ボタンをクリックすると、自動的に<code>name_en</code>の値による色分けが生成される。各色は、シンボルをダブルクリックすることで調整でき、凡例（ラベル）も変更できる。
<img src="day1/pic/Qpic31.png" alt="スタイルc" /></p>
<p>最後に、不要な分類を選択し削除する。<code>OK</code>をクリックすると変更が適用される。
<img src="day1/pic/Qpic32.png" alt="スタイルc" /></p>
<h3><a class="header" href="#ラベル" id="ラベル">ラベル</a></h3>
<p>データを表示する際に、属性情報に基づいてラベルを作成する機能です。以下では、属性値を用いて、ラベルを表示する手法について解説しています。</p>
<p>デフォルトでは「ラベルなし」になっているので、<code>ラベル</code>のポップアップメニューを選択し、<code>単一のラベル</code>を指定し、ラベルのもととなる属性を指定する。ここでは、<code>name_en</code>を指定する。<code>OK</code>をクリックすると変更が適用され、地図上にラベルが表示される。
<img src="day1/pic/Qpic33.png" alt="スタイルc" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#地図タイルの読み込み" id="地図タイルの読み込み">地図タイルの読み込み</a></h2>
<p>　以下では、QGISにXYZタイル形式の背景地図（地理院タイル等）を読み込む手法について解説します。</p>
<p>アイコンが並ぶ箇所（グレーの個所）で右クリックし、<code>パネル＞ブラウザパネル</code>をクリックする。<code>ブラウザパネル＞XYZ Tiles</code>を探し、右クリックし<code>新しい接続</code>をクリックする。
<img src="day1/pic/Qpic34.png" alt="xyz" /></p>
<p>国土地理院の<a href="http://maps.gsi.go.jp/development/ichiran.html">地理院タイル</a>のページから、<code>２．基本測量成果以外で出典の記載のみで利用可能なもの＞タイル一覧＞空中写真・衛星画像＞2007年～</code>を選択し、URLをコピーする。コピーしたURL、名前、ズームレベルを以下のように設定する。<code>OK</code>をクリックすると、ブラウザパネルにタイルが追加される。追加されたタイルをクリックすると、レイヤウィンドウにレイヤとして追加でき、地図も表示される。</p>
<p><img src="day1/pic/Qpic35.png" alt="xyz" /></p>
<p><img src="day1/pic/Qpic36.png" alt="xyz" /></p>
<p>※ 地理院タイルを利用する場合は、利用規約に従ってください。</p>
<p>【註】画像上に地物のラベルを重ね合わせて表示すると、ラベルが画像に紛れて読みにくいことがあります。そのような場合は、レイヤプロパティ＞ラベル＞バッファにて、「テキストバッファを描画する」をクリックし、テキストを縁取り表示させることで見やすくなります。</p>
<h3><a class="header" href="#xyzタイルの一括読み込み" id="xyzタイルの一括読み込み">XYZタイルの一括読み込み</a></h3>
<p>事前にタイル情報を記述したxmlファイルを用いて、<code>接続をロード</code>から、複数のタイルをを一括で読み込むことが可能です。ここでは、使用データのファイル内にある<code>gisoer_tiles.xml</code>を利用します。</p>
<blockquote>
<p>gisoer_tilesは、株式会社MIERUNEの<a href="https://github.com/MIERUNE/mierune-qgis">GitHub(MIERUNE/mierune-qgis)</a>を参考に作成したものです。</p>
</blockquote>
<p><img src="day1/pic/Qpic37.png" alt="xyz" /></p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#地図のレイアウト" id="地図のレイアウト">地図のレイアウト</a></h2>
<p>　以下では、スタイリングしたデータと地理院タイルを用いて、地図をレイアウトして画像として出力する手法について解説します。この実習をはじめる前に、地図画面を任意の地域に拡大してください（以下では、東京大学本郷キャンパス周辺を表示しています）。</p>
<p><code>プロジェクト＞新規プリントレイアウト</code>を選択し、タイトル（地図名など任意）を入力する。データが重ならない場合は、オンザフライCRS投影がうまくいっていない可能性があるので、QGISを再起動する。その後、サンプルデータ、XYZタイルの順で読み込む。
<img src="day1/pic/Qpic38.png" alt="地図のレイアウト" /></p>
<h3><a class="header" href="#プリントコンポーザ" id="プリントコンポーザ">プリントコンポーザ</a></h3>
<p>プリントレイアウトでは、以下の機能を利用して地図を作成することができる。
<img src="day1/pic/Qpic39.png" alt="プリントコンポーザ" /></p>
<ol>
<li>アイテムの選択と移動</li>
<li>地図の移動</li>
<li>地図の追加</li>
<li>画像の追加</li>
<li>テキストの追加</li>
<li>凡例の追加</li>
<li>縮尺バーの追加</li>
<li>地図の出力</li>
</ol>
<p>※アイテムの削除は編集から行う。</p>
<h4><a class="header" href="#レイアウト" id="レイアウト">レイアウト</a></h4>
<p>以下のような地図を作成するため、地図、縮尺バー、凡例、タイトル等を追加する。</p>
<p><img src="day1/pic/Qpic40.png" alt="レイアウト" /></p>
<h4><a class="header" href="#地図の追加" id="地図の追加">地図の追加</a></h4>
<p>地図の追加ボタンをクリックし、地図のレイアウト画面上でドラッグして大きさを指定して、地図を追加する。※追加される地図は、QGISで表示している範囲となる。
<img src="day1/pic/Qpic41.png" alt="レイアウト" /></p>
<h4><a class="header" href="#縮尺バーの追加" id="縮尺バーの追加">縮尺バーの追加</a></h4>
<p>　以下のように、矢印の位置をクリックし、縮尺バーを追加する（ドラッグでの追加も可能）。縮尺バーを選択した状態で、アイテムプロパティのタブに切り替え、線分列の大きさの値等を変更する。
<img src="day1/pic/Qpic42.png" alt="縮尺" /></p>
<p><img src="day1/pic/Qpic43.png" alt="縮尺" /></p>
<h4><a class="header" href="#凡例の追加" id="凡例の追加">凡例の追加</a></h4>
<p>縮尺と同様に凡例を追加する。凡例を選択し、アイテムプロパティで調整する。自動アップデートのチェックをはずすと凡例が編集できる。名称の変更、凡例項目の追加と削除ができる。
<img src="day1/pic/Qpic44.png" alt="凡例" /></p>
<p><img src="day1/pic/Qpic45.png" alt="凡例" /></p>
<h4><a class="header" href="#方位記号の追加" id="方位記号の追加">方位記号の追加</a></h4>
<p>画像の追加から方位記号を追加する。<code>アイテムプロパティ＞検索ディレクトリ</code>をクリックし、方位記号を選択する。デフォルトの状態では、図の赤枠部分をクリックしないと検索ディレクトリが開かないため、注意する。以下のように、アイテムプロパティで、画像の調節を行う。
<img src="day1/pic/Qpic46.png" alt="方位" /></p>
<h4><a class="header" href="#テキストの追加" id="テキストの追加">テキストの追加</a></h4>
<p>テキストの追加からテキストを追加する。メインプロパティに入力したいテキストを記述する。
<img src="day1/pic/Qpic47.png" alt="text" /></p>
<p>以下のように、フォントのサイズや配置等を調節する。
<img src="day1/pic/Qpic48.png" alt="text" /></p>
<p>同様の手法で、任意の個所に、背景地図やデータのライセンス等必要な情報をテキストで追加する。</p>
<h3><a class="header" href="#画像の出力" id="画像の出力">画像の出力</a></h3>
<p>地図のレイアウトを整えた後、画像としてエクスポートする。<code>レイアウト＞画像としてエクスポート</code>を選択する。
<img src="day1/pic/Qpic49.png" alt="エクスポート" /></p>
<p>エクスポートした画像ファイルをダブルクリックすると、以下のような地図が表示できる。画像を出力した後、プリントレイアウトを閉じる。
<img src="day1/pic/Qpic50.png" alt="エクスポートを表示" /></p>
<h3><a class="header" href="#qgisのビュー上に凡例と方位記号を表示する" id="qgisのビュー上に凡例と方位記号を表示する">QGISのビュー上に凡例と方位記号を表示する</a></h3>
<p><code>ビュー&gt;地図装飾</code>を選択する。地図装飾からスケールバー、方位記号を追加する。それぞれの表示にチェックを入れ、形式や配置を調整し<code>OK</code>をクリックする。
<img src="day1/pic/Qpic51.png" alt="view" /></p>
<p>以下のように、QGISのビュー上に縮尺と方位記号が表示される。
<img src="day1/pic/Qpic52.png" alt="ビューb" /></p>
<h2><a class="header" href="#作業ファイルの保存" id="作業ファイルの保存">作業ファイルの保存</a></h2>
<p>QGISには、作業ファイルを保存する機能がある。これにより、一度QGISを閉じた後でも、前回の状態から作業を再開することができる。</p>
<p><code>プロジェクト＞名前を付けて保存</code>をクリックし、任意の名称で出力する。次回開くときは、出力した.qgzファイルをダブルクリックするとQGISが立ち上がる。
<img src="day1/pic/Qpic53.png" alt="save" /></p>
<p>【註】Macではインストール後に.qgzファイルとQGIS3の関連付けがなされていませんので、クリックしたときにアプリケーションの選択を聞かれますので、そこでQGIS3を「開くアプリケーション」として指定してください。</p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#プラグイン" id="プラグイン">プラグイン</a></h2>
<p>　QGISでは、オフィシャルプラグインリポジトリ等から、様々な拡張機能をプラグインとしてインストールできます。プラグインをインストールすることにより、様々な処理が可能になります。<strong>プラグインの実際の使用法は、他の教材で解説しているため、ここではインストール方法のみ解説しています。</strong></p>
<p><code>プラグイン＞プラグインの管理とインストール</code>を選択する。
<img src="day1/pic/Qpic54.png" alt="プラグインのインストール" /></p>
<p>検索から、インストールしたいプラグインを検索する。例として、以下のような便利なプラグインがある。
【註】OpenLayers Pluginのように、プラグイン＞設定にて「実験的プラグインも表示する」にチェックを入れないと検索候補として表示されないものもあります。</p>
<p><img src="day1/pic/Qpic55.png" alt="プラグインの例" />  </p>
<h2><a class="header" href="#データの保存形式" id="データの保存形式">データの保存形式</a></h2>
<p>　GISでは、Shapefile（シェープファイル）形式のベクトルデータを用いることが多いです。しかし、使用するソフトウェアやアプリケーションによっては、別の形式のファイルを使用します。ここでは、QGISによるデータのエクスポートについて解説します。</p>
<p>レイヤの上で右クリックし名前をつけて保存をクリックする。QGISでは、シェープファイル以外にも、KMLやCSV等、様々な形式のデータを出力することができる。
<img src="day1/pic/Qpic59.png" alt="データの保存" /></p>
<p>KMLは、Google Earthで利用できる形式である。Cesiumなどを利用することで、Web上でも表現しやすいデータである。
<img src="day1/pic/Qpic60.png" alt="KML" />
上の図は、東京駅から東京タワーまでの道のりを表示したもの。</p>
<p>CSVは、カンマで区切られたデータ形式である。座標値をもっていればCartoなどで簡単にWeb GISとして表現できる。
<img src="day1/pic/Qpic61.png" alt="CSV" />
上の図は、裾野市オープンデータ　広域避難地・市指定避難所データを加工したものを利用し作成したもの</p>
<p><a href="day1/./QGIS.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday1taskst_qgis_entryhtml課題ページ_qgisビギナーズマニュアルaへ進む" id="この教材のa-hrefday1taskst_qgis_entryhtml課題ページ_qgisビギナーズマニュアルaへ進む">この教材の<a href="day1/./tasks/t_qgis_entry.html">課題ページ_QGISビギナーズマニュアル</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項" id="ライセンスに関する注意事項">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day1/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題qgisビギナーズマニュアル" id="課題qgisビギナーズマニュアル">課題：QGISビギナーズマニュアル</a></h1>
<p>　この課題はGISの入門として、QGISを用いて地図の作成を行うものです。各課題の手順と<a href="day1/tasks/../../QGIS/QGIS.html">QGISビギナーズマニュアル</a>を参考に、完成例のような地図を作成しましょう。GIS初学者は、本教材を進める前に<a href="day1/tasks/../../00/00.html">GISの基本概念</a>教材を一読してください。</p>
<h3><a class="header" href="#実習用データ" id="実習用データ">実習用データ</a></h3>
<p>本実習をはじめる前に、<a href="https://raw.githubusercontent.com/gis-oer/datasets/master/vector/fkuchiyama_sample.zip">fkuchiyama_sample.zip</a>をダウンロードしてください。</p>
<h2><a class="header" href="#課題①_地図のレイアウト" id="課題①_地図のレイアウト">課題①_地図のレイアウト</a></h2>
<p>　平成26年8月豪雨後に実施した京都府福知山市でのフィールド調査（インタビュー）データを用いて、完成例のような地図を作成してください。また、作成する地図は、調査地点、凡例、方位、縮尺バー、タイトル等をレイアウトしたものとします。</p>
<h3><a class="header" href="#完成例" id="完成例">完成例</a></h3>
<p><img src="day1/tasks/pic/tQ1.png" alt="完成例" /></p>
<h2><a class="header" href="#手順" id="手順">手順</a></h2>
<ol>
<li>QGISに実習用データを読み込む</li>
<li>ブラウザパネルから、地理院タイルを読み込む</li>
<li>ポイントのスタイルを調整する</li>
<li>完成例のように、地図をレイアウトする</li>
</ol>
<h3><a class="header" href="#この課題を動画で学ぶ" id="この課題を動画で学ぶ">この課題を動画で学ぶ</a></h3>
<p>この動画は、上記の手順をまとめたものです。画面の大きさや再生速度等を調節して、ご利用ください。</p>
<div style = "text-align: center;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/dxON6QwP2Tg" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>
<h4><a class="header" href="#実習用データのソース" id="実習用データのソース">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#既存データの地図データと属性データ" id="既存データの地図データと属性データ">既存データの地図データと属性データ</a></h1>
<p>　本教材は、「既存データの地図データと属性データの実習用教材」です。GISのデータは、複数の形式があり、様々な機関が提供しています。本教材では、無償で提供されるGISデータや、そのダウンロード手法について解説しています。</p>
<h2><a class="header" href="#menu-1" id="menu-1"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day1/07.html#%E5%9B%BD%E5%9C%9F%E5%9C%B0%E7%90%86%E9%99%A2%E3%81%AE%E5%9F%BA%E7%9B%A4%E5%9C%B0%E5%9B%B3%E6%83%85%E5%A0%B1">国土地理院の基盤地図情報</a></li>
<li><a href="day1/07.html#%E5%9B%BD%E5%9C%9F%E4%BA%A4%E9%80%9A%E7%9C%81%E3%81%AE%E5%9B%BD%E5%9C%9F%E6%95%B0%E5%80%A4%E6%83%85%E5%A0%B1">国土交通省の国土数値情報</a></li>
</ul>
<p>以下は解説を省略したため、関心のある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day1/07.html#%E7%92%B0%E5%A2%83%E7%9C%81%E3%81%AEgis%E3%83%87%E3%83%BC%E3%82%BF">環境省のGISデータ</a></li>
<li><a href="day1/07.html#%E7%B7%8F%E5%8B%99%E7%9C%81%E3%81%AEgis%E3%83%87%E3%83%BC%E3%82%BF">総務省のGISデータ</a></li>
<li><a href="day1/07.html#g%E7%A9%BA%E9%96%93%E6%83%85%E5%A0%B1%E3%82%BB%E3%83%B3%E3%82%BF%E3%83%BC">G空間情報センター</a></li>
<li><a href="day1/07.html#%E7%A0%94%E7%A9%B6%E6%A9%9F%E9%96%A2%E3%81%8C%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8Bgis%E3%83%87%E3%83%BC%E3%82%BF">研究機関、研究者が提供するGISデータ</a></li>
<li><a href="day1/07.html#%E5%9C%B0%E6%96%B9%E8%87%AA%E6%B2%BB%E4%BD%93%E3%81%8C%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8Bgis%E3%83%87%E3%83%BC%E3%82%BF">地方自治体が提供するGISデータ</a></li>
<li><a href="day1/07.html#%E5%9B%BD%E5%A4%96%E3%81%AE%E6%A9%9F%E9%96%A2%E3%81%8C%E6%8F%90%E4%BE%9B%E3%81%99%E3%82%8Bgis%E3%83%87%E3%83%BC%E3%82%BF">国外の機関が提供するGISデータ</a></li>
</ul>
<h2><a class="header" href="#国土地理院の基盤地図情報" id="国土地理院の基盤地図情報">国土地理院の基盤地図情報</a></h2>
<p>　基盤地図情報は、国土交通省国土地理院が整備しているデータです。市町村や2次メッシュ単位で、測量の基準点のほか、行政区画の境界（2500レベル以上）や道路縁（2500レベル以上）等がダウンロードできます。また、地形表現や解析等で用いることのできるDEM（Digital Elevation Model）もダウンロードすることができます。基盤地図情報として提供されているデータは、ダウンロード後に変換が必要です。以下では、基盤地図情報からデータをダウンロードする手法について解説しています。教材に従って任意のファイルを選択し、ダウンロードを試してください。※基盤地図情報の利用については、測量法に従ってください。</p>
<h3><a class="header" href="#アカウントの作成" id="アカウントの作成">アカウントの作成</a></h3>
<p><a href="https://fgd.gsi.go.jp/download/menu.php">基盤地図情報ダウンロードサービス</a>にアクセスし、右上にある「ログイン」メニューからログインする。アカウントがない場合は、ログイン画面の所で「新規登録」のリンクがあるので、アカウントの新規登録を行う。</p>
<h3><a class="header" href="#基盤地図情報基本項目ベクタデータの取得" id="基盤地図情報基本項目ベクタデータの取得">基盤地図情報基本項目：ベクタデータの取得</a></h3>
<p>ログインした状態で、<a href="https://fgd.gsi.go.jp/download/menu.php">基盤地図情報ダウンロードサービス</a>から<code>基盤地図情報　基本項目のファイル選択へ</code>をクリックする。地図をスクロールし、ダウンロードするデータを選択する。ここでは、練習として東京大学本郷キャンパスが含まれる<code>533946</code>を選択し、<code>ダウンロードファイル確認へ</code>をクリックする。データが選択できたら、全てチェックをクリックし、まとめてダウンロードをクリックする。変換する範囲が都道府県全体のように大きいと、処理に時間がかかるため、練習では<code>533946</code>の区画のみとする。以下の動画も参考にデータのダウンロードを練習してください。</p>
<div style = "text-align: center;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/-o-W7Xz9BtI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<h3><a class="header" href="#ダウンロードしたデータの表示とエクスポート" id="ダウンロードしたデータの表示とエクスポート">ダウンロードしたデータの表示とエクスポート</a></h3>
<p>以下では、基盤地図情報基本項目をベクトルデータに変換する手法として、QGISを利用する手法とFGDVを利用する手法を解説します。</p>
<h4><a class="header" href="#qgisでのデータの表示と出力" id="qgisでのデータの表示と出力">QGISでのデータの表示と出力</a></h4>
<p>ダウンロードした.zipを解凍し、以下の手順を実行します。1.xmlをQGISにドラッグアンドドロップする。この際、座標系を指定するウィンドウが立ち上がるため、2.フィルターからJGD2011を検索し、3.OKをクリックする。しばらくするとデータが表示される。上記の手順を繰り返し、ファイル内の.xmlを読み込む。
<img src="day1/pic/7pic_1-1.png" alt="ビューアb" /></p>
<p>データが表示されたのを確認し、レイヤーウィンドウのデータの上で右クリックし、<code>エクスポート&gt;地物の保存</code>を選択する。次に、1.ESRI Shapefileを指定し、2.ファイル名と保存場所を設定する。最後に、3.OKをクリックする。
<img src="day1/pic/7pic_1-2.png" alt="ビューアb" /></p>
<p>※Shapefileは複数のファイルで出力されるため、出力したファイルを移動する際は、すべて移動するように注意する（.shpのみを移動したために、データが表示できないというミスが多い）。</p>
<h4><a class="header" href="#基盤地図情報数値標高モデルdemラスタデータの取得" id="基盤地図情報数値標高モデルdemラスタデータの取得">基盤地図情報数値標高モデル(DEM)：ラスタデータの取得</a></h4>
<p>ログインした状態で、<a href="https://fgd.gsi.go.jp/download/menu.php">基盤地図情報ダウンロードサービス</a>から<code>基盤地図情報　数値標高モデルのファイル選択へ</code>をクリックする。</p>
<p>地図をスクロールし、ダウンロードするデータを選択する（ここでは、例として東京大学本郷キャンパスが含まれる<code>533946</code>を選択し、<code>ダウンロードファイル確認へ</code>をクリックする。</p>
<p>データが選択できたら、全てチェックをクリックし、まとめてダウンロードをクリックする。ダウンロード後、Zipファイルを解凍する。</p>
<h4><a class="header" href="#基盤地図情報からダウンロードしたdemを変換する" id="基盤地図情報からダウンロードしたdemを変換する">基盤地図情報からダウンロードしたDEMを変換する</a></h4>
<p>　基盤地図情報からダウンロードした数値標高モデルをGISソフトウェアで処理するためには、ラスタデータへの変換が必要です。以下では、<a href="http://www.ecoris.co.jp/contents/demtool.html">株式会社エコリスのＨＰ</a>のコンバーターを用いた変換について解説しています。<a href="http://www.ecoris.co.jp/contents/demtool.html">株式会社エコリスのＨＰ</a>から、<code>標高DEMデータ変換ツール</code>をダウンロードし、DEMtool.zipを解凍する。解凍したファイルを開き、変換結合.vbsを実行する。</p>
<p>投影法を尋ねるダイアログが出るので、緯度経度を選択するために'0'を入力する。陰影図の作成が必要な場合は、「はい」をクリックする（今回はいいえとした）。
<img src="day1/pic/7pic_3.png" alt="DEMを変換" /></p>
<p>基盤地図情報からダウンロードしたDEMが入っているフォルダを選択し、海域の標高値を選択する（今回は「はい → 0」を選択した）。変換作業を開始し、完了のメッセージを待つ。変換対象として選んだフォルダー内に、[番号].tifの名前を持つファイル群が出力されているかを確認する。
<img src="day1/pic/7pic_4.png" alt="DEMを変換" /></p>
<p>ファイルの変換が終了すると、ファイル内に<code>merge.tif</code>が出力されるため、これをQGISで読み込み、データを確認する（標高に応じて白と黒の濃淡が表現されていることを確認する）。ラスタデータの配色（値に応じた色分け）は、<a href="day1/../10/10.html">空間データの統合・修正</a>の教材で解説している。</p>
<h3><a class="header" href="#地理院地図" id="地理院地図">地理院地図</a></h3>
<p>国土地理院が提供するデジタル地図として、<a href="https://maps.gsi.go.jp">地理院地図</a>があります。地理院地図では、2万5千分の1地形図や空中写真等を電子化した電子国土基本図のほか、土地条件図などの主題図を閲覧することができます。地理院地図は、オープンソースとして提供されています。タイルで配信されているデータは、WEB地図やGISソフトウェアで背景地図として利用することができます。</p>
<p><a href="day1/./07.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#国土交通省の国土数値情報" id="国土交通省の国土数値情報">国土交通省の国土数値情報</a></h2>
<p>　国土数値情報は、国土交通省が整備しているGISデータで、国土計画の策定や推進のために提供されているものです。ほとんどのデータが、シェープファイルで提供されています。以下では、国土数値情報のサイトから、データをダウンロードする手法について解説をしています。教材に従って任意のファイル（3.地域　学校など）を選択し、ダウンロードを試してください。</p>
<ol>
<li>
<p><a href="http://nlftp.mlit.go.jp/ksj/">国土数値情報</a>のサイトにアクセスする。JPGIS形式もしくは、旧統一フォーマットを選択し、任意の項目にチェックをいれて下段の<code>選択</code>をクリックする。</p>
</li>
<li>
<p>データの範囲を決めるため、任意の地域にチェックをいれ選択をクリックする。今回は最新版の世界測地系のデータをダウンロードすることとし、該当する項目にチェックをいれ、<code>選択</code>をクリックする。</p>
</li>
<li>
<p>アンケートに回答し、利用約款を読み<code>はい</code>をクリックする。</p>
</li>
<li>
<p><code>ダウンロード</code>をクリックすると、データが保存できる。QGISなどでデータを読み込む場合は、ダウンロード後に.Zip形式のファイルを解凍する必要がある。</p>
</li>
</ol>
<p>以下は、上記の手順を動画にまとめたものです。</p>
<div style = "text-align: center;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/Pn-XRt9t1oU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p><a href="day1/./07.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday1taskst_07html課題ページ_既存データの地図データと属性データaへ進む" id="この教材のa-hrefday1taskst_07html課題ページ_既存データの地図データと属性データaへ進む">この教材の<a href="day1/./tasks/t_07.html">課題ページ_既存データの地図データと属性データ</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-1" id="ライセンスに関する注意事項-1">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day1/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題既存データの地図データと属性データ" id="課題既存データの地図データと属性データ">課題：既存データの地図データと属性データ</a></h1>
<p>　日本では、様々な機関からGISで利用できるデータが、提供されています。この実習は、それらのデータをダウンロードする手法とその活用について学ぶものです。GISオープン教材の<a href="day1/tasks/../../07/07.html">既存データの地図データと属性データ</a>の教材を参考に、任意のサイトからデータを取得し地図を作成してください。GIS初学者は、本教材を進める前に<a href="day1/tasks/../../00/00.html">GISの基本概念</a>の教材を確認しておいてください。</p>
<h2><a class="header" href="#課題②_データのダウンロードと活用" id="課題②_データのダウンロードと活用">課題②_データのダウンロードと活用</a></h2>
<p>　以下の1〜4のデータをそれぞれのサイトからダウンロードし、1～4を重ね合わせ、災害（洪水）を想定した防災マップを作成してください。ここでは、任意の地域（居住または、出身等）のデータを取得し、必要な場合は.shpまたは、.tiffに変換してください。作成する地図は、避難所が10地点程度となるまでにズームし、タイトル、凡例、方位をつけ、<strong>1~3</strong> のレイヤのスタイルを調節（見やすく）したものとします。 4のスタイルの変更は不要です（4のスタイルの変更は、<a href="day1/tasks/../../10/10.html">空間データの統合・修正</a>等で扱う内容です）。</p>
<ul>
<li>データ1：基盤地図情報の基本項目の2500レベルの道路データ</li>
<li>データ2：国土数値情報の避難施設データ</li>
<li>データ3：国土数値情報の浸水想定区域データ</li>
<li>データ4：基盤地図情報数値標高モデル 10m DEM</li>
</ul>
<p>※データ1、2、3、4を重ね合わせて、災害時に利用できる道路と避難所を示す。</p>
<h3><a class="header" href="#本実習の注意点" id="本実習の注意点">本実習の注意点</a></h3>
<ul>
<li>シェープファイルは複数で1つのファイル（.shp .shx .dbfなど）であるため、移動する際はすべて移動する</li>
</ul>
<h1><a class="header" href="#ネットワーク分析" id="ネットワーク分析">ネットワーク分析</a></h1>
<p>　本教材は、「ネットワーク分析」の実習用教材です。GISソフトウェアを用いた、最短経路検索や到達圏検索の手法について解説したものです。</p>
<h2><a class="header" href="#menu-2" id="menu-2"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day1/12.html#%E6%9C%80%E7%9F%AD%E8%B7%9D%E9%9B%A2%E6%A4%9C%E7%B4%A2">最短距離検索</a></li>
</ul>
<p>以下に関心がある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day1/12.html#%E3%83%8D%E3%83%83%E3%83%88%E3%81%AE%E5%88%86%E5%89%B2">ネットの分割</a></li>
<li><a href="day1/12.html#%E5%88%B0%E9%81%94%E5%9C%8F%E5%88%86%E6%9E%90">到達圏分析</a></li>
<li><a href="day1/12.html#%E5%B7%A1%E5%9B%9E%E3%82%BB%E3%83%BC%E3%83%AB%E3%82%B9%E3%83%9E%E3%83%B3%E5%95%8F%E9%A1%8C">巡回セールスマン問題</a></li>
<li><a href="day1/12.html#%E3%82%B5%E3%83%96%E3%83%8D%E3%83%83%E3%83%88%E8%A8%AD%E5%AE%9A">サブネット設定</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/network.zip">network</a>をダウンロードしてください。</p>
<h2><a class="header" href="#最短距離検索" id="最短距離検索">最短距離検索</a></h2>
<p>　QGISで、2点間の最短距離を求める手法について解説します。この実習をはじめる前に<code>hospital.shp</code>と<code>path.shp</code>をQGISに読み込んでください。</p>
<p><code>プロセッシング＞ツールボックス＞ネットワーク解析＞最短経路（ポイントからポイント）</code>をクリックする。地図上で経路を検索したい二点の場所をクリックし、実行すると最短経路が表示される。
<img src="day1/pic/12pic_1.png" alt="QGISで最短距離検索" /></p>
<p>表示されている道路を基準にして、経路を検索したい二点の場所をクリック。
最短経路を表示するウインドウに検索結果が表示される。
<img src="day1/pic/12pic_2.png" alt="QGISで最短距離検索" /></p>
<p>出発点を一つとし、各病院間の最短経路を出力する場合は、<code>プロセッシング＞ツールボックス＞ネットワーク解析＞最短経路（ポイントからポイント）</code>をクリックし、地図上で出発点の場所を指定する。処理を実行すると各病院までの最短経路が表示される。
<img src="day1/pic/12pic_3.png" alt="QGISで最短距離検索" /></p>
<p>分析結果を確認するため、<code>プロパティ＞シンボロジー＞分類された</code>から、カラムをコスト（出力した各病院までの最短経路の長さ）とし、分類をクリックする。ラインの色や太さを調整し、OKをクリックする。
<img src="day1/pic/12pic_4.png" alt="QGISで最短距離検索" /></p>
<h4><a class="header" href="#この教材のa-hrefday1taskst_12html課題ページ_ネットワーク分析aへ進む" id="この教材のa-hrefday1taskst_12html課題ページ_ネットワーク分析aへ進む">この教材の<a href="day1/./tasks/t_12.html">課題ページ_ネットワーク分析</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-2" id="ライセンスに関する注意事項-2">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day1/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題ネットワーク分析" id="課題ネットワーク分析">課題：ネットワーク分析</a></h1>
<p>　 GISでは、道路などのラインデータ等を用いて任意の地点間の経路等を求める場合等にネットワーク分析が用いられます。この実習は、道路データを用いたネットワーク分析として最短経路検索を行うものです。以下の手順とGISオープン教材の<a href="day1/tasks/../../12/12.html">ネットワーク分析</a>の教材を参考に、完成例のような地図が作成できれば、完了となります。GIS初学者は、本教材を進める前に<a href="day1/tasks/../../00/00.html">GISの基本概念</a>の教材を確認しておいてください。</p>
<h3><a class="header" href="#実習用データ-1" id="実習用データ-1">実習用データ</a></h3>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/taketomi.zip">taketomi</a>をダウンロードしてください。</p>
<h2><a class="header" href="#課題③_最短経路検索" id="課題③_最短経路検索">課題③_最短経路検索</a></h2>
<p>　最短経路検索は、任意の地点間の最短経路を取得する際に用いられる手法です。QGISで簡単にできる最短経路検索を以下の手順と<a href="day1/tasks/../../12/12.html">ネットワーク分析</a>を参考に行い地図を作成後、以下の課題に回答してください。</p>
<ul>
<li>竹富港からコンドイビーチまでの最短経路（標高などのコストを含まない）とその距離を回答してください。</li>
</ul>
<h3><a class="header" href="#完成例-1" id="完成例-1">完成例</a></h3>
<p><img src="day1/tasks/pic/t12-1.png" alt="kadai" /></p>
<h3><a class="header" href="#手順-1" id="手順-1">手順</a></h3>
<ol>
<li><code>road.shp</code>と<code>points.shp</code>をQGISで読み、<code>points.shp</code>のラベル（<code>Name</code>フィールド）を表示する。</li>
<li>プロセッシングツールボックスを開き、最短経路（ポイントからポイント）を実行する。</li>
<li>属性テーブルから、最短距離（<code>cost</code>フィールド）を確認する。</li>
<li>完成例のように、最短経路を示した地図をレイアウトする。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-1" id="実習用データのソース-1">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-2" id="2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-2">2019年度　地球惑星環境科学科リモートセンシング・ GISおよび実習 （GIS回）</a></h1>
<h2><a class="header" href="#26木ベクタデータ分析入門" id="26木ベクタデータ分析入門">2/6(木)：ベクタデータ分析入門</a></h2>
<ol>
<li>空間座標系の変換</li>
<li>基本的な空間解析（ディゾルブやクリップ等）</li>
<li>領域分析（バッファ）</li>
<li>点データの分析（メッシュ集計、カーネル密度推定）</li>
</ol>
<p><a href="https://docs.google.com/forms/d/1mpFTUR7-Tu5eCJNloIMaEKOTFB1Y9mX8ZO7hk0RbGPE/edit?usp=sharing">Day 2 課題提出フォーム</a></p>
<h3><a class="header" href="#実習の注意事項-2" id="実習の注意事項-2">実習の注意事項</a></h3>
<p>この実習から、以下の点に注意して学習を進めてください。</p>
<ul>
<li>実習用データは、ダウンロードした後、座標を確認・変換して利用してください。※データのダウンロード時に、フォルダ内のすべてのデータを変換することが望ましい。</li>
<li>適切な座標系が指定されていない地図を提出した場合は、減点対象となります。</li>
<li>教材内で同じデータを再度取得するような指示がありますが、すでに対象のデータを取得・変換した場合は、そのデータを利用してください。※ データの管理方法等は、各自で検討してください（作業の効率がよくなるように整理して保管する）。</li>
<li>この実習では、ラスタデータの座標変換は無視してください。</li>
</ul>
<h1><a class="header" href="#空間データ" id="空間データ">空間データ</a></h1>
<p>　本教材は、「空間データ」の実習用教材です。GISソフトウェア（QGIS）を用いて、空間座標の変換、ジオリファレンス、ジオコーディングについて解説しています。講義用教材として、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/3.html">地理情報科学教育用スライド（GIScスライド）</a>の3章が参考になります。</p>
<h2><a class="header" href="#menu-3" id="menu-3"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day2/08.html#%E7%A9%BA%E9%96%93%E5%BA%A7%E6%A8%99%E3%81%AE%E5%A4%89%E6%8F%9B">空間座標の変換</a></li>
</ul>
<p>以下は解説を省略したため、関心のある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day2/08.html#%E3%82%B8%E3%82%AA%E3%83%AA%E3%83%95%E3%82%A1%E3%83%AC%E3%83%B3%E3%82%B9">ジオリファレンス</a></li>
<li><a href="day2/08.html#%E3%82%B8%E3%82%AA%E3%82%B3%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0">ジオコーディング</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/sabae.zip">Sabae</a>をダウンロードしてください。</p>
<h2><a class="header" href="#空間座標の変換" id="空間座標の変換">空間座標の変換</a></h2>
<p>　地理空間情報（GISで扱うことのできるデータ）は、測地系と座標系に基づいた位置情報を保持しています。測地系や座標系は様々なものがあります。そのため、複数のデータを処理する場合は、各データの座標系を統一する必要があります。その際に、空間座標の変換を行います。以下では、QGISを用いた変換手法を解説しています。空間座標系についての解説は、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/3.html">地理情報科学教育用スライド（GIScスライド）</a>の3章や<a href="day2/../00/00.html">GISの基本概念</a>の教材を参照してください。また、この実習を始める前に、以下の座標変換の正誤事例を参照し、今後の作業で誤った座標変換を行わないように注意してください。</p>
<div style = "text-align: center;">
<iframe width="560" height="315" src="https://www.youtube.com/embed/jAHJNI5CiKw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></div>
<p><strong>※以下の教材で使用しているQGIS3.4では、JGD2011の変換のエラーがあるため、JGD2011のデータに対してJGD2000を割り当てている点に注意してください。</strong></p>
<h3><a class="header" href="#測地系変換" id="測地系変換">測地系変換</a></h3>
<p><a href="https://github.com/gis-oer/datasets/raw/master/sabae.zip">Sabae</a>をダウンロードし、以下の手順に従って、sabae_aed_tokyo（日本測地系 緯度経度）とsabae_aed_jgd2000（世界測地系　緯度経度）のシェープファイルをQGISに読み込む。
<img src="day2/pic/8pic_1.png" alt="測地系変換" /></p>
<ol>
<li>データソースマネージャを開く。</li>
<li>エンコーディングをUTF-8に設定し、ソースから、ダウンロードした日本測地系と世界測地系のshape（sabae_aed_jgd2000とsabae_aed_tokyo）を指定する。</li>
<li>「追加」 をクリックする。</li>
</ol>
<p>この際に、QGISが自動で、擬似的な位置あわせをしてしまうため、オンザフライ投影の機能をオフにする。</p>
<p><img src="day2/pic/8pic_2.png" alt="測地系変換" /></p>
<ol>
<li>右下のEPSGのボタンをクリックする。</li>
<li>投影なしにチェックをつけ、オンザフライ投影を無効にする。</li>
</ol>
<p>以下のように、データは同じ場所のものにもかかわらず、座標系が異なるためずれて表示されることを確認する。
<img src="day2/pic/8pic_3.png" alt="測地系変換" /></p>
<p>それぞれのレイヤの上で右クリックして、プロパティ（ソースのタブ）から座標系を確認する。
<img src="day2/pic/8pic_4.png" alt="測地系変換" /></p>
<p>以下の手順で、日本測地系を世界測地系へ変換する。
<img src="day2/pic/8pic_5.png" alt="測地系変換" /></p>
<ol>
<li>プロパティ＞エクスポート＞地物の保存をクリックする 。</li>
</ol>
<p><img src="day2/pic/8pic_6.png" alt="測地系変換" />
2. 新規レイヤの出力先と名前を選択する。
3. CRSを選択するために、図中の③をクリックし、フィルターからJGD2000を検索し、OKをクリックする。
4. OKをクリックする。</p>
<p>以下のように、測地系がJGD2000に変換された。
<img src="day2/pic/8pic_7.png" alt="測地系変換" /></p>
<h3><a class="header" href="#投影変換" id="投影変換">投影変換</a></h3>
<p>以下では、地理座標系のデータを投影座標系の平面直角座標系へ変換する手法について解説する。世界測地系緯度経度のデータを用いて、以下の処理を行う。
<img src="day2/pic/8pic_8.png" alt="測地系変換" /></p>
<ol>
<li>プロパティ＞エクスポート＞地物の保存をクリックする。</li>
<li>新規レイヤの出力先と名前を選択する。</li>
<li>CRSのボタンをクリックし、変更したいCRSを選択（JGD2000 / Japan Plane Rectangular CS Ⅵ）してOKをクリックする。</li>
<li>OKをクリックする。</li>
</ol>
<p>以下のように、座標系が（JGD2000 / Japan Plane Rectangular CS Ⅵ）に変換された。座標系が変換したため、レイヤが重なって表示されないことを確認する。
<img src="day2/pic/8pic_9.png" alt="測地系変換" /></p>
<p>※世界測地系の平面直角座標系へ変換する場合に、地域によって○○系と指定する必要がある。詳しくは、国土地理院の[平面直角座標系の対応表]を参考にする。</p>
<p><strong>※空間座標の変換のよくある間違いとして、新規にデータを作成せず、プロパティ（一般情報）の空間参照システムからCRSを選択する等があるため、今後同様の処理を実行するときに注意する。</strong></p>
<p><a href="day2/./08.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday2taskst_08html課題ページ_空間データaへ進む" id="この教材のa-hrefday2taskst_08html課題ページ_空間データaへ進む">この教材の<a href="day2/./tasks/t_08.html">課題ページ_空間データ</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-3" id="ライセンスに関する注意事項-3">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day2/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題空間データ" id="課題空間データ">課題:空間データ</a></h1>
<p>　この実習は、空間座標の変換について学ぶためのものです。以下の手順と<a href="day2/tasks/../../08/08.html">空間データ</a>の教材を参考に、完成例のような地図を作成してください。</p>
<h2><a class="header" href="#menu-4" id="menu-4"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day2/tasks/t_08.html#%E8%AA%B2%E9%A1%8C1_%E7%A9%BA%E9%96%93%E5%BA%A7%E6%A8%99%E3%81%AE%E5%A4%89%E6%8F%9B">課題1_空間座標の変換</a></li>
</ul>
<h3><a class="header" href="#実習用データ-2" id="実習用データ-2">実習用データ</a></h3>
<p>本実習をはじめる前に、以下のデータをダウンロードしてください。</p>
<ul>
<li>課題1 <a href="https://github.com/gis-oer/datasets/raw/master/tasks/tokyo23ku-cvs_task.zip">東京23区コンビニ</a></li>
</ul>
<h2><a class="header" href="#課題①_空間座標の変換" id="課題①_空間座標の変換">課題①_空間座標の変換</a></h2>
<p>　<a href="https://github.com/gis-oer/datasets/raw/master/tasks/tokyo23ku-cvs_task.zip">東京23区コンビニ</a>のデータを世界測地系の平面直角座標系へ投影変換し、地図をレイアウトしてください。次に、地理座標系と投影座標系の違いについて、WEBで調べて300字程度でまとめてください。</p>
<h3><a class="header" href="#完成例-2" id="完成例-2">完成例</a></h3>
<p><img src="day2/tasks/pic/t8-1.png" alt="完成例" /></p>
<h3><a class="header" href="#手順-2" id="手順-2">手順</a></h3>
<ol>
<li><code>tokyo23ku-cvs_jgd2000.shp</code>をQGISに表示する。</li>
<li>平面直角座標系（JGD2011の9系）に変換する。変換後の座標変換の結果がわかりづらいため、QGIS画面右下のEPSGコード6677に設定し直す。</li>
<li>地図をレイアウトする。</li>
<li>QGISの作業ファイル（.qgs）に任意の名前をつけ保存し、画面を閉じる。</li>
<li>地理座標系と投影座標系の違いについて、300字程度でまとめる。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-2" id="実習用データのソース-2">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#基本的な空間解析" id="基本的な空間解析">基本的な空間解析</a></h1>
<p>　本教材は、「基本的な空間解析」の実習用教材です。GISソフトウェア（QGIS）を用いた、地物の計測、ディゾルブ、クリップなどの空間解析手法について解説しています。講義用教材として、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章が参考になります。</p>
<h2><a class="header" href="#menu-5" id="menu-5"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day2/11.html#%E5%9F%BA%E6%9C%AC%E9%87%8F%E3%81%AE%E6%B8%AC%E5%AE%9A%E3%81%A8%E7%A9%BA%E9%96%93%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E9%81%B8%E6%8A%9E">基本量の測定と空間オブジェクトの選択</a></li>
<li><a href="day2/11.html#%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E7%A9%BA%E9%96%93%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E6%93%8D%E4%BD%9C">その他の空間データの操作</a></li>
<li><a href="day2/11.html#%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E3%83%AC%E3%82%A4%E5%88%86%E6%9E%90">オーバーレイ分析</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/tokyo_s.zip">tokyo</a>と<a href="https://github.com/gis-oer/datasets/raw/master/shinobazu.zip">shinobazu</a>をダウンロードしてください。</p>
<h2><a class="header" href="#課題_基本量の測定と空間オブジェクトの選択" id="課題_基本量の測定と空間オブジェクトの選択">課題_基本量の測定と空間オブジェクトの選択</a></h2>
<p>　GISでは、データの形状や属性情報を用いて、地物の長さや面積を計測することができます。ここでは、東京都23区の行政区域と地理院タイル（空中写真・衛星画像）を用いて、不忍池の周長と面積の計測を行います。QGISでの計測は、手動のものと自動のものがあり、以下では両方の手法を解説します。</p>
<p>　東京都23区の境界データを先に読み込んだ後に、ブラウザパネルのXYZタイルの追加から、地理院タイル（空中写真・衛星画像）を読み込んで下さい。
<img src="day2/pic/11pic_1.png" alt="手動計算" /></p>
<h3><a class="header" href="#手動で長さor面積を計測する方法" id="手動で長さor面積を計測する方法">手動で、長さor面積を計測する方法</a></h3>
<p>計測ツールをクリックし、<code>線の長さを測る</code>を選択する。
<img src="day2/pic/11pic_2.png" alt="手動計算" /></p>
<h4><a class="header" href="#不忍池の周長を測定" id="不忍池の周長を測定">不忍池の周長を測定</a></h4>
<p>池の外周を縁取るように、点を打ち、最初の点と重なったところで右クリックすると周長が計算できる。
<img src="day2/pic/11pic_3.png" alt="手動計算" /></p>
<h4><a class="header" href="#不忍池の面積を測定" id="不忍池の面積を測定">不忍池の面積を測定</a></h4>
<p>池の外周を縁取るように、点を打ち、最初の点と重なったところで右クリックすると面積が計算できる。
<img src="day2/pic/11pic_4.png" alt="手動計算" /></p>
<h3><a class="header" href="#フィールド演算から長さor面積を計算する方法" id="フィールド演算から長さor面積を計算する方法">フィールド演算から、長さor面積を計算する方法</a></h3>
<p><a href="https://github.com/gis-oer/datasets/raw/master/shinobazu.zip">shinobazu</a>のポリゴンを読み込み、周長と面積を計算する。
<img src="day2/pic/11pic_5.png" alt="自動計算" /></p>
<ol>
<li>属性テーブルを開き、編集モードに切り替える。</li>
<li>フィールド計算機を開く。</li>
</ol>
<p>新規フィールドを作成し、フィールド演算を行う。
<img src="day2/pic/11pic_6.png" alt="自動計算" /></p>
<ol>
<li>「新しいフィールドを作る」にチェックする。</li>
<li>フィールド名：　perimeter</li>
<li>出力フィールドタイプ：　real</li>
<li>出力フィールド幅：　10 ※任意で変更可</li>
<li>精度：　5 ※任意で変更可</li>
<li>関数：　ジオメトリから$perimeterをダブルクリックする。※式に$perimeterが表示される。</li>
</ol>
<ul>
<li>※今回は周長なので$perimeterを選択する。</li>
<li>※線長を計測する場合には、$lengthを使用する。</li>
</ul>
<ol start="7">
<li>OKをクリックする。　※面積の計測には、同じ手順で、$areaを使用する。</li>
</ol>
<p>周長(length)と面積(area)のフィールドがつくられる。
<img src="day2/pic/11pic_7.png" alt="自動計算" /></p>
<h3><a class="header" href="#フィールド計算を用いた計算" id="フィールド計算を用いた計算">フィールド計算を用いた計算</a></h3>
<p>フィールド計算機では、様々な関数による計算を行うことができる。以下では、よく利用される関数を紹介したものである。</p>
<table><thead><tr><th>関数名</th><th>処理内容</th></tr></thead><tbody>
<tr><td>$length</td><td>線長</td></tr>
<tr><td>$area</td><td>面積</td></tr>
<tr><td>$geometry</td><td>ジオメトリ</td></tr>
<tr><td>$x</td><td>x座標</td></tr>
<tr><td>$y</td><td>y座標</td></tr>
<tr><td>$id</td><td>連番</td></tr>
</tbody></table>
<h3><a class="header" href="#空間オブジェクトの選択" id="空間オブジェクトの選択">空間オブジェクトの選択</a></h3>
<p>以下では、空間オブジェクトの選択の例として、台東区を検索する手法について解説しています。</p>
<p>地図から選択する場合、選択ボタンを利用する。レイヤウィンドウで対象レイヤをクリックし、青色になっているのを確認したのち、地物選択をクリックする。地図上で、台東区の場所をクリックすると、色が黄色（選択色）になる。
<img src="day2/pic/11pic_8.png" alt="自動計算" /></p>
<p>属性テーブルから、選択したエリアの情報を表示することができる。
<img src="day2/pic/11pic_9.png" alt="自動計算" /></p>
<ol>
<li>属性テーブルを開き選択した地物を表示する。</li>
<li>地図で選択した地物のみ表示される。</li>
</ol>
<p><a href="day2/./11.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#その他の空間データの操作" id="その他の空間データの操作">その他の空間データの操作</a></h2>
<p>　GISでは、データの位置、形状、属性を用いて新たにデータを作成することができます。以下では、マージ（複数のデータを1つに結合）、ディゾルブ（属性を用いてデータを融合する）、クリップ（重なっているデータを指定し、特定の範囲を切り取る）について解説します。マージ、ディゾルブ、クリップの詳しい説明は、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章を参照してください。</p>
<p>※あらかじめ、新規にフォルダを作成し、台東区と墨田区のシェープファイルを移動して下さい。シェープファイルは複数のデータで一つのファイルであるため、移動の際はすべてを動かすようにして下さい（.shpファイルのみ移動すると、データが表示できない）。</p>
<h3><a class="header" href="#台東区と墨田区のポリゴンをマージmergeする" id="台東区と墨田区のポリゴンをマージmergeする">台東区と墨田区のポリゴンをマージ(Merge)する</a></h3>
<p>空間選択から作成した台東区と墨田区のポリゴンデータをQGISで読み込む。<code>ベクタ＞データマネージメントツール＞複数のシェープファイルを一つに結合する</code>からマージする。
<img src="day2/pic/11pic_10.png" alt="マージ" /></p>
<ol>
<li>ポリゴンを選択する。</li>
<li>ブラウズから入力ディレクトリを選択する。</li>
<li>ブラウズから出力するシェープファイルの保存する場所と名前を入力する。</li>
<li>OKをクリックする。</li>
</ol>
<p>台東区と墨田区がマージされ、一つのポリゴンになった。
<img src="day2/pic/11pic_11.png" alt="マージ" /></p>
<h3><a class="header" href="#マージしたポリゴンをデイゾルブdissolveする" id="マージしたポリゴンをデイゾルブdissolveする">マージしたポリゴンをデイゾルブ(Dissolve)する</a></h3>
<p><code>ベクタ＞空間演算ツール＞融合</code>からディゾルブを行う(町丁目界のないポリゴンの作成)。
<img src="day2/pic/11pic_12.png" alt="デイゾルブ" /></p>
<ol>
<li>入力レイヤを選択する。</li>
<li>ディゾルブフィールドを指定する（融合フィールドは、属性が統一されている行を選択する）</li>
<li>ブラウズから、出力場所と名前を入力する。</li>
<li>実行をクリックする。</li>
</ol>
<p>町丁目界がなくなり、単純なポリゴンが作成できた。
<img src="day2/pic/11pic_13.png" alt="デイゾルブ" /></p>
<h3><a class="header" href="#点データポリゴンでクリップclipする" id="点データポリゴンでクリップclipする">点データポリゴンでクリップ(Clip)する</a></h3>
<p><code>ベクタ＞空間演算ツール＞クリップ</code> からクリップを行う（対象エリアにあるレイヤの切り取り）。
23区のコンビニデータを読み込む。
<img src="day2/pic/11pic_14.png" alt="クリップ" /></p>
<ol>
<li>入力レイヤをポイントにする。</li>
<li>オーバーレイヤを融合にする。</li>
<li>ブラウズから、出力場所と名前を入力する。</li>
<li>実行をクリックする。　※入力レイヤ：　切り取りたいレイヤ。 クリップレイヤ：　クリップに使うレイヤ。</li>
</ol>
<p>台東区と墨田区にあるコンビニが抽出できた。
<img src="day2/pic/11pic_15.png" alt="クリップ" /></p>
<p><a href="day2/./11.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#オーバーレイ分析" id="オーバーレイ分析">オーバーレイ分析</a></h2>
<p>　オーバーレイ分析は、空間データを重ね合わせブール演算をもとに領域を抽出する手法である。以下では、インターセクトとユニオンの手法について解説している。インターセクトとユニオンの詳しい説明は、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章を参照してください。</p>
<h3><a class="header" href="#インターセクトintersect" id="インターセクトintersect">インターセクト(Intersect)</a></h3>
<p>国土数値情報の河川レイヤを用いて、東京の河川データを読み込み、インターセクトし(Intersect)別のポリゴンを作成する。<code>ベクター＞空間演算ツール＞交差</code>からインターセクトを実行する。
<img src="day2/pic/11pic_16.png" alt="クリップ" /></p>
<ol>
<li>入力ベクタレイヤを河川にする。</li>
<li>交差レイヤを融合にする。</li>
<li>ブラウズから、出力場所と名前を入力する。</li>
<li>実行をクリックする。</li>
</ol>
<p>江東区と墨田区に交差する河川レイヤが新規に作成できた。</p>
<p>※属性情報をチェックしクリップとの違いを確認する。属性情報は更新されないのでラインの長さやポリゴンやの面積は、再計算が必要な点に注意する。
<img src="day2/pic/11pic_17.png" alt="クリップ" /></p>
<h3><a class="header" href="#ユニオン-union" id="ユニオン-union">ユニオン (Union)</a></h3>
<p>台東区と墨田区のポリゴンを一つのポリゴンに統合する。　　　　　　　　　　　　　　　
<code>ベクター＞空間演算ツール＞統合</code>からユニオンを行う。
<img src="day2/pic/11pic_18.png" alt="ユニオン" /></p>
<ol>
<li>入力レイヤをディゾルブした23区のポリゴンにする 。</li>
<li>オーバーレイヤを台東区と墨田区のポリゴンにする。</li>
<li>ブラウズから、出力場所と名前を入力する。</li>
<li>実行をクリックする。</li>
</ol>
<p>台東区と墨田区のポリゴンを一つのポリゴンに統合できた。
<img src="day2/pic/11pic_19.png" alt="ユニオン" /></p>
<p><a href="day2/./11.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday2taskst_11html課題ページ_基本的な空間解析aへ進む" id="この教材のa-hrefday2taskst_11html課題ページ_基本的な空間解析aへ進む">この教材の<a href="day2/./tasks/t_11.html">課題ページ_基本的な空間解析</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-4" id="ライセンスに関する注意事項-4">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day2/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題基本的な空間解析" id="課題基本的な空間解析">課題：基本的な空間解析</a></h1>
<p>　本実習では、空間データから新たなデータを計測する手法および複数の空間データの位置関係から新規データの作成や距離の計測を行います。課題1としてGISソフトウェア上で地物の大きさを計測する手法を学びます。課題2では、ベクトルデータの形状を用いて新規のデータを作成する手法を学びます。以下の手順とGISオープン教材の<a href="day2/tasks/../../11/11.html">基本的な空間解析</a>の教材を参考に、完成例のような地図が作成できれば、完了となります。</p>
<h3><a class="header" href="#実習用データ-3" id="実習用データ-3">実習用データ</a></h3>
<p>本実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/osaka_s.zip">osaka</a>をダウンロードしてください。</p>
<h2><a class="header" href="#menu-6" id="menu-6"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day2/tasks/t_11.html#%E8%AA%B2%E9%A1%8C1_%E5%91%A8%E9%95%B7%E3%81%A8%E9%9D%A2%E7%A9%8D%E3%81%AE%E8%A8%88%E6%B8%AC">課題1_周長と面積の計測</a></li>
<li><a href="day2/tasks/t_11.html#%E8%AA%B2%E9%A1%8C2_%E3%83%87%E3%83%BC%E3%82%BF%E3%81%AE%E5%BD%A2%E7%8A%B6%E3%82%84%E5%B1%9E%E6%80%A7%E3%82%92%E7%94%A8%E3%81%84%E3%81%9F%E8%A7%A3%E6%9E%90">課題2_データの形状や属性を用いた解析</a></li>
</ul>
<h2><a class="header" href="#課題②_周長と面積の計測" id="課題②_周長と面積の計測">課題②_周長と面積の計測</a></h2>
<p>　GISで示される地物は、位置や形状が座標で管理されています。そのためGIS上で、周長や面積計算を行うことができます。以下の手順と<a href="day2/tasks/../../11/11.html">基本的な空間解析</a>の教材を参考に、を参考に、大阪市の24区の行政界を用いて、それぞれの周長と面積を算出した後、浪速区の周長と面積を回答してください。</p>
<h3><a class="header" href="#手順-3" id="手順-3">手順</a></h3>
<ol>
<li>QGISで、<code>osaka_6kei.shp</code>を読み込む。</li>
<li>新規属性テーブルを作成し、区ごとに周長を計測する。</li>
<li>同じように新規属性テーブルを作成し、各市町村ポリゴンごとに面積を計測する。</li>
<li>地図から浪速区を空間選択し、属性テーブルの周長と面積確認し、質問に回答する。</li>
</ol>
<h2><a class="header" href="#課題③_データの形状や属性を用いた解析" id="課題③_データの形状や属性を用いた解析">課題③_データの形状や属性を用いた解析</a></h2>
<p>　この実習は、解析に必要な範囲を求め、新規レイヤとして抽出するものです。GISでは、ベクトルデータの保持する形状、位置、属性等の情報を用いることで特定の条件にあった新規レイヤを抽出することができます。以下の手順と<a href="day2/tasks/../../11/11.html">基本的な空間解析</a>の教材を参考に、淀川が流れる区のみを抽出し、完成例のような図を作成してください。
　</p>
<h3><a class="header" href="#完成例-3" id="完成例-3">完成例</a></h3>
<p><img src="day2/tasks/pic/t11-1.png" alt="kadai" /></p>
<h3><a class="header" href="#手順-4" id="手順-4">手順</a></h3>
<ol>
<li><code>osaka_6kei.shp</code>、<code>yodo_river.shp</code>、<code>school.shp</code>をQGISで読み込む。</li>
<li>淀川が流れる市町村を選択して、<code>名前を付けて保存</code>から出力する。</li>
<li>2で出力したポリゴンをデイゾルブする。</li>
<li>ディゾルブしたポリゴンを用いて、淀川をクリップする。</li>
<li>ディゾルブしたポリゴンを用いて、区内の学校をインターセクトする</li>
<li>出力したデータを用いて地図をレイアウトする。</li>
</ol>
<h4><a class="header" href="#完成例で使用したデータ" id="完成例で使用したデータ">完成例で使用したデータ</a></h4>
<p>本ページで使用しているデータの出典については、該当する教材よりご確認ください。</p>
<h1><a class="header" href="#領域分析" id="領域分析">領域分析</a></h1>
<p>　本教材は、「領域分析」の実習用教材です。GISソフトウェア（QGIS）を用いた、バッファなどの領域分析の手法について解説しています。本実習と対応する講義用教材として、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章が参考になります。</p>
<h2><a class="header" href="#menu-7" id="menu-7"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day2/13.html#%E3%83%90%E3%83%83%E3%83%95%E3%82%A1">バッファ</a></li>
</ul>
<p>以下に関心がある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day2/13.html#%E3%83%9C%E3%83%AD%E3%83%8E%E3%82%A4%E5%88%86%E5%89%B2">ボロノイ分割</a></li>
<li><a href="day2/13.html#%E3%83%89%E3%83%AD%E3%83%BC%E3%83%8D%E4%B8%89%E8%A7%92%E5%BD%A2">ドローネ三角形</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/tokyo_s.zip">tokyo</a>をダウンロードしてください。</p>
<h2><a class="header" href="#バッファ" id="バッファ">バッファ</a></h2>
<p>　バッファは、地物からの距離に応じて、一定の領域を作成する手法です。以下では、QGISと実習用データを利用し、ポイントデータからバッファを作成する手法や、一定の距離に区切った多重リングバッファを作成する手法について解説します。加えて、バッファで作成した領域を用いた、空間検索の手法も解説します。</p>
<h3><a class="header" href="#点バッファの作成" id="点バッファの作成">点バッファの作成</a></h3>
<p>以下では、バッファの例として、東京都のコンビニデータを利用し、コンビニから500mのバッファを算出し、空間検索でバッファと重なる郵便局を抽出する。まず、バッファを作成するために、<code>ベクタ＞空間演算ツール＞バッファ</code>を選択し、以下の手順を実行する。
<img src="day2/pic/13pic_1.png" alt="500mのバッファ" /></p>
<ol>
<li>コンビニのポイントデータを選択（※事前に投影座標系であることを確認しておくと良い）。</li>
<li>距離を500と設定。</li>
<li>円を近似させる線分の数10を入力する。（数が多いほどきれいな円になる）。</li>
<li>出力先と名称を指定。</li>
<li>OKをクリック。</li>
</ol>
<p>(左)各コンビニから500mのエリアが表示できた。
(右)結果を融合にチェックをいれた場合の例。
<img src="day2/pic/13pic_2.png" alt="500mのバッファ" /></p>
<h3><a class="header" href="#線バッファと面バッファ" id="線バッファと面バッファ">線バッファと面バッファ</a></h3>
<p>同じ方法で、ラインやポリゴンからのバッファも作成できる。
<img src="day2/pic/13pic_12.png" alt="線バッファと面バッファ" /></p>
<h3><a class="header" href="#空間検索を利用した抽出" id="空間検索を利用した抽出">空間検索を利用した抽出</a></h3>
<p>以下では、空間検索を利用して、バッファと重なる地物を選択する手法について解説します。</p>
<p><code>ベクタ＞調査ツール＞場所による選択</code>をクリックする。
<img src="day2/pic/13pic_4.png" alt="空間検索" /></p>
<ol>
<li>ソース地物の選択、郵便局を選択。</li>
<li>交わるをチェック。</li>
<li>バッファを選択。</li>
<li>実行をクリック。</li>
</ol>
<p>下の図のように、コンビニから500m圏内の郵便局が選択された。
<img src="day2/pic/13pic_5.png" alt="空間検索" /></p>
<h3><a class="header" href="#多重リングバッファ" id="多重リングバッファ">多重リングバッファ</a></h3>
<p>多重リングバッファを実行するため、<code>プラグイン＞プラグインの管理とインストール　からMulti-distance buffer</code>をインストールする。</p>
<p><code>プラグインをインストール</code>をクリックする。
<img src="day2/pic/13pic_7.png" alt="多重リングバッファ" /></p>
<p><code>ベクタ＞Multi-distance buffer＞Multi-distance buffer</code>から以下の手順で多重リングバッファを作成する。
<img src="day2/pic/13pic_8.png" alt="多重リングバッファ" /></p>
<ol>
<li>コンビニを選択。</li>
<li><code>Add</code>で距離を追加。</li>
<li>出力レイヤ名を入力。</li>
<li>OKをクリック。</li>
</ol>
<p>100mごとの多重リングバッファができた。<code>名前をつけて保存</code>から新規レイヤとして出力する。
<img src="day2/pic/13pic_9.png" alt="多重リングバッファ" /></p>
<p>属性データを用いて、100mごとの色分けを行う。
<img src="day2/pic/13pic_10.png" alt="多重リングバッファ" /></p>
<p>下の図のように、100mごとの多重リングバッファの表示が変更された。  
<img src="day2/pic/13pic_11.png" alt="多重リングバッファ" /></p>
<p><a href="day2/./13.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材の課題ページ_領域分析へ進む" id="この教材の課題ページ_領域分析へ進む">この教材の[課題ページ_領域分析]へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-5" id="ライセンスに関する注意事項-5">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day2/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題領域分析" id="課題領域分析">課題:領域分析</a></h1>
<p>　この実習は、ポイントデータから領域を作成する手法として、バッファを行うものです。以下の手順とGISオープン教材の<a href="day2/tasks/../../13/13.html">領域分析</a>の教材を参考に、地図を作成してください。GIS初学者は、本教材を進める前に<a href="day2/tasks/../../00/00.html">GISの基本概念</a>の教材を確認しておいてください。</p>
<h3><a class="header" href="#実習用データ-4" id="実習用データ-4">実習用データ</a></h3>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/osaka_s.zip">osaka</a>をダウンロードしてください。</p>
<h2><a class="header" href="#課題④_バッファの作成" id="課題④_バッファの作成">課題④_バッファの作成</a></h2>
<p>　大阪市およびその周辺の河川（<code>river.shp</code>）と学校（<code>school.shp</code>）を用いて、河川(<code>river.shp</code>)から200m圏内に含まれる学校（<code>school.shp</code>）の件数を回答してください。</p>
<h3><a class="header" href="#手順-5" id="手順-5">手順</a></h3>
<ol>
<li>ダウンロードしたデータをQGISで読み込む。</li>
<li><code>ベクタ＞空間演算ツール＞バッファ</code>から200mのバッファを作成する。</li>
<li><code>ベクタ＞調査ツール＞場所による選択</code>で空間検索を実行し、属性テーブルからバッファ内の保育施設の数を計測する。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-3" id="実習用データのソース-3">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#点データの分析" id="点データの分析">点データの分析</a></h1>
<p>　本教材は、「点データの分析」の実習用教材です。QGISを用いて、点データの密度を可視化し視覚的に分析する手法や、点パターン分布を数理的に分析する手法について解説しています。理論の解説は、講義用教材の<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章が参考になります。</p>
<h2><a class="header" href="#menu-8" id="menu-8"><strong>Menu</strong></a></h2>
<p><strong>視覚的分析</strong></p>
<ul>
<li><a href="day2/14.html#%E7%82%B9%E3%81%AE%E5%88%86%E5%B8%83%E5%AF%86%E5%BA%A6">点の分布密度</a></li>
<li><a href="day2/14.html#%E3%83%A1%E3%83%83%E3%82%B7%E3%83%A5%E3%81%AB%E3%82%88%E3%82%8B%E7%82%B9%E5%AF%86%E5%BA%A6%E3%81%AE%E8%A1%A8%E7%A4%BA">メッシュによる点密度の表示</a></li>
<li><a href="day2/14.html#%E8%A1%8C%E6%94%BF%E5%8C%BA%E5%86%85%E3%81%AE%E7%82%B9%E5%AF%86%E5%BA%A6">行政区内の点密度</a></li>
<li><a href="day2/14.html#%E3%82%AB%E3%83%BC%E3%83%8D%E3%83%AB%E5%AF%86%E5%BA%A6%E6%8E%A8%E8%A8%88">カーネル密度推計</a></li>
</ul>
<p>以下は解説を省略したため、関心のある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day2/14.html#%E5%B9%B3%E5%9D%87%E6%9C%80%E8%BF%91%E9%9A%A3%E8%B7%9D%E9%9B%A2%E6%B3%95">平均最近隣距離法</a></li>
<li><a href="day2/14.html#%E6%A8%99%E6%BA%96%E5%81%8F%E5%B7%AE%E8%B7%9D%E9%9B%A2%E3%81%A8%E6%A8%99%E6%BA%96%E5%81%8F%E5%B7%AE%E6%A5%95%E5%86%86">標準偏差距離と標準偏差楕円</a></li>
<li><a href="day2/14.html#k-%E9%96%A2%E6%95%B0%E6%B3%95">K-関数法</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/tokyo_s.zip">tokyo</a>をダウンロードしてください。</p>
<hr />
<h2><a class="header" href="#視覚的分析" id="視覚的分析">視覚的分析</a></h2>
<p>　以下では、国土数値情報のコンビニエンスストアのデータを用いて、QGISでポイントデータの密度を視覚的に分析する手法について解説しています。前提として、点データの視覚的分析では、メッシュや行政区画などの空間集計に用いるオブジェクトの大きさに影響されることを注意する必要があります。</p>
<h2><a class="header" href="#点の分布密度" id="点の分布密度">点の分布密度</a></h2>
<p>　下の図は、QGISでcvs_jgd2011_9.shpファイルを読み込み、東京都のコンビニエンスストアの分布を示したものです。この図を見ると点が密集している地域とそうでない地域があることはわかります。しかし、地域ごとの密度の違いはよくわかりません。そこで、以下ではQGISでメッシュ（方形区）や行政区画ごとに密度を可視化する手法を解説します。
<img src="day2/pic/14pic_1.png" alt="点の分布" /></p>
<h2><a class="header" href="#メッシュによる点密度の表示" id="メッシュによる点密度の表示">メッシュによる点密度の表示</a></h2>
<p><code>プロセッシング＞ツールボックス＞ベクター作成＞グリッドの作成</code>から以下の手順で、メッシュを作成する。ここでは、500m×500mのメッシュを作成する。
<img src="day2/pic/14pic_2.png" alt="メッシュ" /></p>
<ol>
<li>長方形（ポリゴン）を選択する。</li>
<li>レイヤの領域を使うため、cvs_jgd2011_9を選択する。</li>
<li>水平、垂直方向をそれぞれ500mとする。</li>
<li>出力先とファイル名を指定する。</li>
<li>実行をクリックする。</li>
</ol>
<p>下の図のように、500m×500mのメッシュが作成できる。
<img src="day2/pic/14pic_3.png" alt="メッシュ" /></p>
<h3><a class="header" href="#メッシュ内のポイント数を計算する" id="メッシュ内のポイント数を計算する">メッシュ内のポイント数を計算する</a></h3>
<p><code>ベクタ＞解析ツール＞ポリゴン内のポイント数</code>からメッシュ内のポイント数を以下のように計算する。
<img src="day2/pic/14pic_4.png" alt="メッシュ" /></p>
<ol>
<li>ポリゴンに出力したメッシュを選択する。</li>
<li>ポイントにコンビニのレイヤ(cvs_jgd2011_9.shp)を指定する。</li>
<li>出力先を指定する。</li>
<li>実行をクリックする。</li>
</ol>
<p>以下のように、メッシュ内のポイント数を集計した、新規ポリゴンが作成される。
<img src="day2/pic/14pic_5.png" alt="メッシュ" />
属性テーブルを開き、一番端の列のデータを並び替えて表示すると、計算結果が追加されていることが確認できる。</p>
<h3><a class="header" href="#メッシュ内のポイント数で色分け" id="メッシュ内のポイント数で色分け">メッシュ内のポイント数で色分け</a></h3>
<p><code>プロパティ＞シンボロジーから</code> メッシュ内のポイント数をもとに色分けを行う。
<img src="day2/pic/14pic_6.png" alt="メッシュ" /></p>
<p>※属性値が、文字型になっていると、ポリゴン内のポイント数の段階づけの色分けができない。そのため、以下の手順で数値型へ変換する。メッシュの属性テーブルを開き、<code>フィールド計算機&gt;新しいフィールドを作る</code>から、フィールド名（任意）を入力し、出力フィールドタイプをintegerにする。次に、<code>フィールドと値</code>からポイントを集計した列名を選択し、OKをクリックする。再計算が完了したのを確認し、編集モード（鉛筆マーク）をクリックし編集結果を保存する。　</p>
<p>以下のように、メッシュごとにコンビニの密度が可視化される。
<img src="day2/pic/14pic_7.png" alt="メッシュ" /></p>
<h2><a class="header" href="#行政区内の点密度" id="行政区内の点密度">行政区内の点密度</a></h2>
<p>　以下では、行政区画のポリゴンを利用し、行政区ごとの点密度を計算する手法について解説しています。tokyo23ku_jgd2011_9.shpを読み込み、<code>解析ツール＞ポリゴン内のポイント数</code>から、以下ののように設定し、行政区ごとのコンビニ数を計算する。
<img src="day2/pic/14pic_8.png" alt="メッシュ" /></p>
<p>計算結果のスタイルをプロパティから設定する。
<code>プロパティ＞シンボロジーから</code>属性値に応じて、以下のようにポリゴンの表現を整える。
<img src="day2/pic/14pic_9.png" alt="メッシュ" /></p>
<h2><a class="header" href="#カーネル密度推計" id="カーネル密度推計">カーネル密度推計</a></h2>
<p>　カーネル密度分析は犯罪発生マップなどに用いられる手法で、カーネル関数を用いてポイントの分布密度を連続的な密度局面としてモデル化する手法です。QGISでは、<code>プロセッシング＞ツールボックス＞データ補間＞ヒートマップ（カーネル密度推定）</code>を選択し、以下のように実行します。
<img src="day2/pic/14pic_10.png" alt="カーネル" /></p>
<p><img src="day2/pic/14pic_12.png" alt="カーネル" /></p>
<ol>
<li>入力ポイントレイヤにコンビニのデータを選択する。</li>
<li>半径を500mとする。</li>
<li><strong>ピクセルサイズをそれぞれ、20とする。</strong> ※ピクセルサイズが、小さすぎると処理時間が長くなるため十分に注意する。</li>
<li>出力ラスタを設定し、実行をクリックする。</li>
</ol>
<p>出力されたラスタの配色を、<code>プロパティ＞シンボロジーから</code>設定する。
<img src="day2/pic/14pic_13.png" alt="カーネル" /></p>
<p>半径の値（バンド幅）を変えて出力し、同じ閾値で分類すると結果が変わることも確認しておくと良い。バンド幅を広くとったカーネルは広域的傾向把握に有効である。一方で、局地的な値への対応が難しくなる。そのため、バンド幅の設定には注意する必要がある。
<img src="day2/pic/14pic_14.png" alt="カーネル" /></p>
<p><a href="day2/./14.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday2taskst_14html課題ページ_点データの分析aへ進む" id="この教材のa-hrefday2taskst_14html課題ページ_点データの分析aへ進む">この教材の<a href="day2/./tasks/t_14.html">課題ページ_点データの分析</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-6" id="ライセンスに関する注意事項-6">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day2/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題点データの分析" id="課題点データの分析">課題：点データの分析</a></h1>
<p>　GISで点データの密度を可視化する場合、分析に用いる空間オブジェクトの形状や大きさを考慮する必要があります。この実習では、メッシュによる集計法を用いて、点データを視覚的に分析します。</p>
<h3><a class="header" href="#実習用データ-5" id="実習用データ-5">実習用データ</a></h3>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/osaka_s.zip">osaka</a>をダウンロードしてください。</p>
<h2><a class="header" href="#課題⑤_メッシュによる点の計測" id="課題⑤_メッシュによる点の計測">課題⑤_メッシュによる点の計測</a></h2>
<p>　均一な大きさのメッシュポリゴン（1kmメッシュ）を作成し、メッシュ内に含まれる学校の数を計測し、配色を調整した地図を作成してください。</p>
<h3><a class="header" href="#完成例-4" id="完成例-4">完成例</a></h3>
<p><img src="day2/tasks/pic/t14-1.png" alt="kadai" /></p>
<h3><a class="header" href="#手順-6" id="手順-6">手順</a></h3>
<ol>
<li><code>school.shp</code>をQGISに読み込む。</li>
<li><code>プロセッシング＞ツールボックス＞ベクター作成＞グリッドの作成</code>から、1kmのメッシュを作成する。</li>
<li><code>ベクタ＞解析ツール＞ポリゴン内のポイント数</code>から、メッシュ内のポイントを計算する。</li>
<li>メッシュ内のポイント数でポリゴンを色分けする。※この際、数値として色分けできない場合は、<code>属性テーブル&gt;編集モードオン&gt;フィールド計算機&gt;新しいフィールドを作成する</code>から、出力フィールドタイプを整数値に指定し値を再計算する。</li>
<li>配色を調整し、地図をレイアウトする。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-4" id="実習用データのソース-4">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-3" id="2019年度-地球惑星環境科学科リモートセンシング-gisおよび実習-gis回-3">2019年度　地球惑星環境科学科リモートセンシング・ GISおよび実習 （GIS回）</a></h1>
<h2><a class="header" href="#27金ラスタデータ分析入門" id="27金ラスタデータ分析入門">2/7(金)：ラスタデータ分析入門</a></h2>
<ol>
<li>空間データの作成・編集・統合・変換</li>
<li>地形情報の可視化、流域解析</li>
<li>空間補間（Triangulation, IDW）</li>
</ol>
<p><a href="https://drive.google.com/open?id=1QjEJwZEG5RP5Q3tXnJWQvYIVAWpapAjlxTjMkFzWU94">Day 3 課題提出フォーム</a></p>
<h1><a class="header" href="#空間データの統合修正" id="空間データの統合修正">空間データの統合・修正</a></h1>
<p>　本教材は、「空間データの統合・修正」の実習用教材です。GISで用いられるラスタデータ（以下、ラスタという）とベクトルデータ（以下、ベクタという）の統合、修正、変換などデータの編集手法について解説しています。ソフトウェアは、無償で利用できるQGISを用いています。</p>
<p>　課題形式で使用する場合は、本教材を一読した後、課題ページへお進みください。GIS初学者は、本教材を進める前に<a href="day3/../00/00.html">GISの基本概念</a>の教材を確認しておいてください。本教材を使用する際は、<a href="day3/../../policy.html">利用規約</a>をご確認いただき、これらの条件に同意された場合にのみご利用下さい。</p>
<h2><a class="header" href="#menu-9" id="menu-9"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day3/10.html#%E3%83%A9%E3%82%B9%E3%82%BF%E3%81%AE%E3%83%A2%E3%82%B6%E3%82%A4%E3%82%AF%E3%81%A8%E3%82%AF%E3%83%AA%E3%83%83%E3%83%97">ラスタのモザイクとクリップ</a></li>
<li><a href="day3/10.html#%E7%AD%89%E9%AB%98%E7%B7%9A%E3%81%AE%E6%8A%BD%E5%87%BA">等高線の抽出</a></li>
<li><a href="day3/10.html#%E3%83%A9%E3%82%B9%E3%82%BF%E3%82%92%E3%83%99%E3%82%AF%E3%82%BF%E3%81%B8">ラスタをベクタへ</a></li>
<li><a href="day3/10.html#%E6%96%B0%E8%A6%8F%E3%83%99%E3%82%AF%E3%82%BF%E3%81%AE%E4%BD%9C%E6%88%90">新規ベクターレイヤの作成</a></li>
</ul>
<p>以下に関心がある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day3/10.html#%E3%83%99%E3%82%AF%E3%82%BF%E3%82%92%E3%83%A9%E3%82%B9%E3%82%BF%E3%81%B8">ベクタをラスタへ</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/fuji.zip">fuji</a>をダウンロードしてください。</p>
<h2><a class="header" href="#ラスタのモザイクとクリップ" id="ラスタのモザイクとクリップ">ラスタのモザイクとクリップ</a></h2>
<p>　以下では、ラスタデータ(ここでは、DEMを使用)の結合と任意範囲での切り抜きの解説を行っています。DEMは、Digital Elevation Modelの略であり、各セルごとに標高値を保持しているデータです。以下に従って、ダウンロードしたデータ（<a href="https://github.com/gis-oer/datasets/raw/master/fuji.zip">fuji</a>）から任意の地域のデータを結合し、切り出して下さい。</p>
<p>ラスタを読み込むボタンをクリックして、<a href="https://github.com/gis-oer/datasets/raw/master/fuji.zip">fuji</a>のラスタを全て読み込む。
<img src="day3/pic/10pic_1.png" alt="ラスタ" /></p>
<h3><a class="header" href="#ラスタのモザイク" id="ラスタのモザイク">ラスタのモザイク</a></h3>
<p>読み込んだ複数の.tifファイルは、<code>ラスタ＞その他＞結合</code>を選択し、以下の手順で一つにまとめる。通常、データが無い値は、0や-9999などを必要に応じて指定する（今回はデフォルトで実行）。
<img src="day3/pic/10pic_2.png" alt="モザイク" /></p>
<ol>
<li>入力ファイルを選択する。</li>
<li>出力先とファイル入力する。</li>
<li>ＯＫをクリックする。</li>
</ol>
<p>以下のように、ラスタが結合できる。
<img src="day3/pic/10pic_3.png" alt="モザイク" /></p>
<h3><a class="header" href="#ラスタの座標変換" id="ラスタの座標変換">ラスタの座標変換</a></h3>
<p>ラスタの座標変換は、<code>ラスタ＞プロジェクション＞ワープ（再投影）</code>から実行する。ここでは、以下の手順で実行する地理座標系から、平面直角座標系に変換する。
<img src="day3/pic/10pic_4.png" alt="座標変換" /></p>
<ol>
<li>入力レイヤとして、結合したラスタを選択する。</li>
<li>変換元の座標系をEPSG:6668とする。</li>
<li>変換先の座標系をEPSG:6676とする。</li>
<li>リサンプリングをバイリニアとする。</li>
<li>Nodata値を0とする。</li>
<li>出力先とファイル名を指定する。</li>
<li><code>実行</code>をクリックする。</li>
</ol>
<h3><a class="header" href="#ラスタのクリップ" id="ラスタのクリップ">ラスタのクリップ</a></h3>
<p><code>ラスタ＞抽出＞範囲によるラスタクリップ</code>をクリックし、分析に必要な範囲のデータを抽出する。以下からは、結合、再投影したラスタ以外のレイヤを削除しておくと良い。
<img src="day3/pic/10pic_5.png" alt="クリップ" /></p>
<ol>
<li>再投影したラスタを入力レイヤに指定する。</li>
<li><code>キャンパス上で領域を指定する</code>をクリックし、地図をドラッグして範囲を指定する。</li>
<li>出力先とファイル名を指定する。</li>
<li>実行をクリックする。</li>
</ol>
<p>以下のように、ラスタがクリップできる。
<img src="day3/pic/10pic_6.png" alt="クリップ" /></p>
<h3><a class="header" href="#ラスタの配色値の分類" id="ラスタの配色値の分類">ラスタの配色(値の分類)</a></h3>
<p>以下では、抽出したデータの配色について解説する。DEMは、ラスタのセルごとに標高値を保持しているため、標高値による色分けができる。色分けは、以下の手順で実行する。
<img src="day3/pic/10pic_7.png" alt="配色" /></p>
<ol>
<li>クリップしたラスタのプロパティ ＞ シンボル体系から、レンダリングタイプを単バンド疑似カラーにする。</li>
<li>最小を0、最大を4000とする。</li>
<li>モードを等分位とし、クラスを9とする。</li>
<li>各値ラベルをクリックし、表示値を書き換える。</li>
<li>OKをクリックする。</li>
</ol>
<p>以下のように、標高値ごとに色わけができる。
<img src="day3/pic/10pic_8.png" alt="標高値" /></p>
<p>以下のように、値の追加や編集によって、応用的に色分けすることも可能である（以下では、2500m以下を青色として表現した）。
<img src="day3/pic/10pic_8-1.png" alt="標高値" /></p>
<p><a href="day3/./10.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#等高線の抽出" id="等高線の抽出">等高線の抽出</a></h2>
<p>　作成したラスタデータは、各セルごとに標高値を保持している。そのため、セルの値を補間、等高線を作成することができる。以下では、等高線の作成は、<code>ラスタ＞抽出＞等高線</code>をクリックを選択し、以下の手順で実行する。
<img src="day3/pic/10pic_9.png" alt="等高線の抽出" /></p>
<ol>
<li>入力ファイルを選択する。</li>
<li>等高線の間隔を入力（今回は、200mとする）する。</li>
<li>出力先とファイルを入力する（ESRI Shapefileで保存する）。</li>
<li>実行をクリックする。</li>
</ol>
<p>以下のように、200mの等高線が出力される。属性テーブルに、標高値が作成されていることも確認しておくと良い。
<img src="day3/pic/10pic_10.png" alt="等高線の抽出" /></p>
<p><a href="day3/./10.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#ラスタをベクターに変換する" id="ラスタをベクターに変換する">ラスタをベクターに変換する</a></h2>
<p>　GISでは、処理の内容やデータの表現のため、ラスタデータやベクタデータを使い分けて使用します。以下では、ラスターデータをベクタデータ(ポリゴン)に変換する手法について解説しています。</p>
<p>ラスタをベクターに変換するため、<code>ラスタ＞変換＞ポリゴン化（ラスタのベクタ化）</code>をクリックし、以下の操作を行う。
<img src="day3/pic/10pic_11.png" alt="ラスタをベクタへ" /></p>
<ol>
<li>入力ファイルを選択する。</li>
<li>作成するフィールドの名前を指定する。</li>
<li>出力先とファイルを入力する。</li>
<li>実行をクリックする。</li>
</ol>
<p>以下のように、ラスタがベクタに変換されるので、DNフィールドの値で色分けする。
<img src="day3/pic/10pic_12.png" alt="ラスタをベクタへ" /></p>
<h3><a class="header" href="#ポリゴンから特定の値例2500m以上の地域を表示する" id="ポリゴンから特定の値例2500m以上の地域を表示する">ポリゴンから特定の値（例：2500m以上の地域）を表示する</a></h3>
<p>作成したポリゴンから、特定の値の地域の抽出しデータを表示する場合は、以下のように行う。レイヤの上で右クリックし、<code>プロパティ&gt;シンボロジー</code>をクリックする。
<img src="day3/pic/10pic_13.png" alt="ラスタをベクタへ" />
「段階に分けられた」を選択し、カラムに「DN」値を指定する。
分類数を1にし、「分類」をクリックする。値をクリックし2500-最大値を入力し、OKをクリックする。</p>
<p><a href="day3/./10.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#新規ベクターレイヤの追加" id="新規ベクターレイヤの追加">新規ベクターレイヤの追加</a></h2>
<p>　GISでは、データを自作をすることができます。以下では、新規にベクトルデータを作成する手法について解説しています。以下をはじめる前に、富士山登山同図（fuji_trails.tif）をQGISで読み込んで下さい。背景図が読み込みが完了したら、<code>レイヤ＞レイヤの作成＞新規シェープファイルレイヤ</code>を選択し、以下の手順でレイヤの作成を行う。
<img src="day3/pic/10pic_14.png" alt="テーブルを編集" /></p>
<ol>
<li>保存先とファイル名を指定する。</li>
<li>作成したいレイヤのタイプを選択する。</li>
<li>座標系（今回は、EPSG:6676とする）を設定する。</li>
<li>新規ポイントに追加したい属性を<code>新フィールド</code>から設定する。</li>
</ol>
<ul>
<li>「名称」はカラム名、「タイプ」はデータ型にあわせる、「幅」と「精度」は入力するデータによる。</li>
<li>「タイプ」・・・値が整数ならInteger、小数を含むならReal、テキストならStringとなる。</li>
<li>「幅」＞桁数、「精度」＞表示する小数の位</li>
</ul>
<ol start="5">
<li>OKをクリックする。</li>
</ol>
<p>※新規ベクターレイヤ追加では、ポイント、ライン、ポリゴンを同時に作成することができない。各レイヤを作成する場合ごとに、新規レイヤ作成が必要となる。</p>
<h3><a class="header" href="#ポイントデータの作成と保存" id="ポイントデータの作成と保存">ポイントデータの作成と保存</a></h3>
<p>以下では、富士山の登山道図をトレースして、山小屋のポイントを作成する。追加するポイントのIDと名前は表を参照する。
レイヤを選択し、<code>編集モード切替</code>をクリックする。
<img src="day3/pic/10pic_15.png" alt="ポイントデータの作成と保存" /></p>
<p><code>ポイント地物を追加する</code>をクリックし、山小屋1の位置をクリックし、idと名前を入力する。この作業をid 12まで行う。
<img src="day3/pic/10pic_16.png" alt="ポイントデータの作成と保存" /></p>
<p>ポイントが追加できたら、<code>レイヤ編集内容を保存（青枠）</code>、<code>編集モード切替（赤枠）</code>の順でクリックしてデータを保存する。
<img src="day3/pic/10pic_17.png" alt="ポイントデータの作成と保存" /></p>
<h3><a class="header" href="#ポイントの削除" id="ポイントの削除">ポイントの削除</a></h3>
<p>以下では、ポイントデータを編集する手法について解説しています。ポイントの削除は、編集モードの状態で、選択ツールを用いて、削除したいレイヤを選択し、選択物を削除をクリックする。
<img src="day3/pic/10pic_18.png" alt="ポイントの削除" /></p>
<h4><a class="header" href="#ポイントの移動" id="ポイントの移動">ポイントの移動</a></h4>
<p>ポイントの移動は、頂点ツールをクリックして、移動したいレイヤの頂点をクリックし、任意の場所に移動する。
<img src="day3/pic/10pic_19.png" alt="ポイントの移動" /></p>
<h4><a class="header" href="#属性情報の編集" id="属性情報の編集">属性情報の編集</a></h4>
<p>QGISでは、以下のように属性テーブルを開き、属性情報をクリックし、編集したい情報を入力することができる。
<img src="day3/pic/10pic_20.png" alt="テーブルを編集" /></p>
<h4><a class="header" href="#ラインデータの作成" id="ラインデータの作成">ラインデータの作成</a></h4>
<p><code>レイヤ＞レイヤの作成＞新規シェープファイルレイヤ</code>から、ポイントレイヤと同様の手法でラインデータを作成します。
<img src="day3/pic/10pic_21.png" alt="ラインデータの作成" /></p>
<p>以下では、頂点を連結させるため、<code>設定＞オプション＞デジタイズ</code>から、<code>デフォルトでスナップオプションを有効にする</code>にチェックをつける。
<img src="day3/pic/10pic_22.png" alt="ラインデータの作成" /></p>
<p>ポイントデータを作成する要領で、登山道を何度もクリックしてなぞるようにラインデータを作成する。作成した線の最後の点で右クリックをするとダイアログが表示されるため、属性情報を入力する（以下では、１．富士宮口の登山道と２．お鉢巡りの道の順で作成します）。
<img src="day3/pic/10pic_23.png" alt="ラインデータの作成" /></p>
<p>お鉢巡りを作成する際に、富士宮口登山道の終点に点が重なるように作成する。最終点の周辺にカーソルを重ねるとピンク色になるので、その場所にお鉢巡りの始点と終点を重ねるように作成する。
<img src="day3/pic/10pic_24.png" alt="ラインデータの作成" /></p>
<h4><a class="header" href="#ポリゴンデータの作成" id="ポリゴンデータの作成">ポリゴンデータの作成</a></h4>
<p>以下では、ポリゴンデータの作成を解説するため、火口のポリゴンを新規に作成する。<a href="day3/../QGIS/QGIS.html">QGISビギナーズマニュアル</a>に従って、<code>ブラウザパネル</code>を表示し、地理院タイル（簡易空中写真）をよみこむ
<img src="day3/pic/10pic_25.png" alt="ポリゴンデータの作成" /></p>
<p><code>レイヤ＞レイヤの作成＞新規シェープファイルレイヤ</code>から、ポイントレイヤと同様の手法でポリゴンデータを作成する。
<img src="day3/pic/10pic_26.png" alt="ポリゴンデータの作成" /></p>
<p>ラインデータを作成する要領で、火口のふちを何度もクリックしてなぞるようにポリゴンデータを作成する。作成した線の最後の点で右クリックをするとダイアログが表示されるため、属性情報を入力する。
<img src="day3/pic/10pic_27.png" alt="ポリゴンデータの作成" /></p>
<p><a href="day3/./10.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday3taskst_10html課題ページ_空間データの統合修正aへ進む" id="この教材のa-hrefday3taskst_10html課題ページ_空間データの統合修正aへ進む">この教材の<a href="day3/./tasks/t_10.html">課題ページ_空間データの統合・修正</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-7" id="ライセンスに関する注意事項-7">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day3/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題空間データの統合修正" id="課題空間データの統合修正">課題：空間データの統合・修正</a></h1>
<p>　この実習は、既存のラスタデータの結合による新規ラスターデータ作成と背景地図をトレースした新規ベクトルデータ作成を行うものです。実習で使われる用語や概念は、地理情報科学教育用スライド（GIScスライド）の4章を参照してください。以下の手順と<a href="day3/tasks/../../10/10.html">空間データの統合・修正</a>の教材を参考に、完成例のような地図が作成できれば、実習完了となります。</p>
<h3><a class="header" href="#実習用データ-6" id="実習用データ-6">実習用データ</a></h3>
<p>本実習を始める前に、<a href="https://github.com/gis-oer/datasets/raw/master/tokyo_s.zip">tokyo</a>をダウンロードしてください。本実習では、tokyo_srtm.tiffのみを使用します。</p>
<h2><a class="header" href="#課題①_ラスタデータのクリップと新規ベクトルデータの作成" id="課題①_ラスタデータのクリップと新規ベクトルデータの作成">課題①_ラスタデータのクリップと新規ベクトルデータの作成</a></h2>
<p>　この実習では、前半で、ラスタデータを任意の範囲で切り抜く処理と、対象範囲内の等高線抽出および標高値の取得を行います。後半では、ベクトルデータの作成の練習として、完成例のような地図を作成します。以下の手順と<a href="day3/tasks/../../10/10.html">空間データの統合・修正</a>教材を参考に実習を進めてください。</p>
<h3><a class="header" href="#完成例-5" id="完成例-5">完成例</a></h3>
<p><img src="day3/tasks/pic/t10.png" alt="kadai" /></p>
<h3><a class="header" href="#手順-7" id="手順-7">手順</a></h3>
<ol>
<li>tokyo_srtm.tiffをQGISに読み込む</li>
<li><a href="day3/tasks/../../QGIS/QGIS.html">QGISビギナーズマニュアル</a>を参考に、ブラウザパネルから地理院タイル（空中写真または標準地図）を読み込む。</li>
<li>地理院タイルを参考に、不忍池、JR上野駅周辺の範囲で、tokyo_srtm.tiffをクリップし、新規ラスタの配色を<code>プロパティ＞シンボロジー</code>で5段階に調整する。  </li>
<li>クリップしたラスタデータを用いて、5m間隔で等高線を抽出する。抽出した等高線のスタイルを整える。</li>
<li>完成例を参考にポイントデータを作成する。ポイントの作成時の属性情報は、id(Integer,幅2)、NAME(String,幅20)、とし、Id(通し番号)、NAME(建物名）を記入する。</li>
<li>地理院タイル（空中写真）を利用して、不忍池のポリゴンを作成する（おおまかでよい）。属性は、id(Integer,幅10)のみとする。ポリゴンの新規作成は、作成後右クリックで新規レイヤとして反映される点に注意する。</li>
<li>地理院タイル（空中写真）を利用して、JR上野駅から不忍池までのルートをラインデータを作成する（おおまかでよい）。</li>
<li>完成例のように作成したレイヤのスタイルを整える。次、ラベルの設定をする。ラベルは、<code>プロパティ＞ラベル</code>から<code>ラベルなし→単一のラベル</code>を選択し、ラベルにするフィールドを指定する。今回は、ポイントをNAME、ラインをELEVで設定する。</li>
<li>背景地図をオフにし、プリントコンポーザから、地図をレイアウトする。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-5" id="実習用データのソース-5">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#ラスタデータの分析" id="ラスタデータの分析">ラスタデータの分析</a></h1>
<p>　本教材は、「ラスタデータの分析」の実習用教材です。各セルに標高値を保持しているラスタデータを用いて、地形解析の手法について解説しています。本教材では、数値標高モデル(DEM)として整備されたデータを用います。DEMは、Digital Elevation Modelの略であり、地形解析等に用いられるデータです。本教材の内容と対応する講義用教材の<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章を一読すると理解が深まります。</p>
<p>　課題形式で使用する場合は、本教材を一読した後、課題ページへお進みください。GIS初学者は、本教材を進める前に<a href="day3/../00/00.html">GISの基本概念</a>の教材を確認しておいてください。本教材を使用する際は、<a href="day3/../../policy.html">利用規約</a>をご確認いただき、これらの条件に同意された場合にのみご利用下さい。</p>
<h2><a class="header" href="#menu-10" id="menu-10"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day3/15.html#%E6%95%B0%E5%80%A4%E6%A8%99%E9%AB%98%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E8%A6%96%E8%A6%9A%E7%9A%84%E5%88%86%E6%9E%90">数値標高モデルの視覚的分析</a></li>
<li><a href="day3/15.html#%E5%9F%BA%E6%9C%AC%E7%9A%84%E3%81%AA%E7%B5%B1%E8%A8%88%E9%87%8F%E3%81%AE%E7%A2%BA%E8%AA%8D">基本的な統計量の確認</a></li>
<li><a href="day3/15.html#%E3%83%A9%E3%82%B9%E3%82%BF%E6%BC%94%E7%AE%97">ラスタ演算</a></li>
<li><a href="day3/15.html#%E6%B5%81%E5%9F%9F%E8%A7%A3%E6%9E%90">流域解析</a></li>
</ul>
<p>以下に関心がある方は、GIS実習オープン教材を参照してください。</p>
<ul>
<li><a href="day3/15.html#%E3%83%99%E3%82%AF%E3%82%BF%E3%81%AE%E5%87%A6%E7%90%86%E3%81%A8%E3%83%A9%E3%82%B9%E3%82%BF%E3%81%AE%E9%9B%86%E8%A8%88%E3%81%AE%E7%B5%84%E3%81%BF%E5%90%88%E3%82%8F%E3%81%9B%E5%88%86%E6%9E%90">ベクタの処理とラスタの集計の組み合わせ分析</a></li>
<li><a href="day3/15.html#%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF%E3%83%AA%E3%83%B3%E3%82%B0">フィルタリング</a></li>
<li><a href="day3/15.html#%E3%82%B3%E3%82%B9%E3%83%88%E3%83%91%E3%82%B9%E8%A7%A3%E6%9E%90">コストパス解析</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/aso.zip">aso</a>をダウンロードしてください。</p>
<h2><a class="header" href="#数値標高モデルの視覚的分析" id="数値標高モデルの視覚的分析">数値標高モデルの視覚的分析</a></h2>
<p>各セルごとに標高値を保持しているラスタデータを用いることで、傾斜区分図、斜面方位図、陰影図、3D地図、断面図を作成することができます。以下では、その手法について解説しています。QGISを起動し、<code>データソースマネージャ&gt;ラスタ</code>からラスタデータを表示してください。
<img src="day3/pic/15pic_1.png" alt="raster" /></p>
<h3><a class="header" href="#標高段彩図の作成" id="標高段彩図の作成">標高段彩図の作成</a></h3>
<p><code>プロパティ＞シンボル体系</code>を選択し、レンダリングタイプを<code>単バンド疑似カラー</code>を選択し<code>OK</code>をクリック押すとラスターの配色が変更できる。
<img src="day3/pic/15pic_2.png" alt="標高段彩図" />
下の図のように、ラスターの配色が変更された。
<img src="day3/pic/15pic_3.png" alt="標高段彩図" /></p>
<p>シンボル体系では、最小、最大値、分類モード、分類数等を指定できる。各項目を設定後、分類をクリックすると反映される。また、各値、ラベルの上で、ダブルクリックすると値、ラベルの指定ができる。
<img src="day3/pic/15pic_4.png" alt="標高段彩図" /></p>
<p>以下では、200ｍ間隔で標高値を色分けした。
<img src="day3/pic/15pic_5.png" alt="標高段彩図" /></p>
<h3><a class="header" href="#傾斜区分図の作成" id="傾斜区分図の作成">傾斜区分図の作成</a></h3>
<p><code>ラスタ＞解析＞傾斜</code>を選択し、<code>実行</code>をクリックすると傾斜区分が計算できる。<strong>複数QGISを起動していると、<code>解析</code>機能が表示されない場合があるため注意する。</strong>
<img src="day3/pic/15pic_6.png" alt="傾斜区分図" /></p>
<p>下の左のように傾斜が計算されるため、図の配色を整え、傾斜区分図を作成する。
<img src="day3/pic/15pic_7.png" alt="傾斜区分図" /></p>
<h3><a class="header" href="#斜面方位図の作成" id="斜面方位図の作成">斜面方位図の作成</a></h3>
<p><code>ラスタ＞地形解析＞傾斜方位</code>を実行すると傾斜方位が計算できる。
<img src="day3/pic/15pic_8.png" alt="斜面方位図" /></p>
<p>下の図のように、斜面方位が出力される。傾斜方位は、360°(0°-359.999°)で計算されるため角度に応じて値を分類する。
<img src="day3/pic/15pic_9.png" alt="斜面方位図" /></p>
<h3><a class="header" href="#陰影図の作成" id="陰影図の作成">陰影図の作成</a></h3>
<p><code>ラスタ＞地形解析＞陰影図</code>を実行すると陰影図が計算できる。
<img src="day3/pic/15pic_10.png" alt="陰影図" /></p>
<p>下の図のように、陰影図が出力される。右下の図のように陰影図に標高値のラスタを重ね、<code>プロパティ＞透過性</code>から透過度を設定すると、立体的な地形表現となり、起伏が読み取りやすくなる。ここでは、陰影図の透過度や色合いを変更しないように注意する。
<img src="day3/pic/15pic_11.png" alt="陰影図" /></p>
<h3><a class="header" href="#鳥瞰図の作成" id="鳥瞰図の作成">鳥瞰図の作成</a></h3>
<p><code>ビュー＞新しい3Dマップビュー</code>を選択し、<code>3Dビューの設定</code>アイコンをクリックする。
<img src="day3/pic/15pic_12.png" alt="鳥瞰図" /></p>
<p>高さに標高値のラスタデータを指定し、ＯＫをクリックする。ウィンドウ内で地図を動かすと3次元表示されていることが確認できる。鉛直スケールを1以上とすると、下の図のように地形を誇張して表現できる。
<img src="day3/pic/15pic_13.png" alt="鳥瞰図" /></p>
<h3><a class="header" href="#地形断面図の作成" id="地形断面図の作成">地形断面図の作成</a></h3>
<p><code>プラグイン＞プラグインの管理とインストール</code>から<code>VoGIS Profile tool</code> をインストールする。</p>
<p><code>ラスタ&gt;VoGIS ProfileTool &gt; VoGIS Profile Tool</code>から起動する。
<img src="day3/pic/15pic_14.png" alt="断面図" /></p>
<p><img src="day3/pic/15pic_15.png" alt="断面図" /></p>
<ol>
<li>断面図を作成するラスタにチェックを入れる。</li>
<li><code>Digitize (new) profile line</code> をクリックする。</li>
<li>QGISの地図上でクリックしながらラインを作成する。（右クリックで終了）</li>
<li><code>Create Profile</code>をクリックすると別ウィンドウに断面形状が表示される。</li>
</ol>
<p><a href="day3/./15.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#基本的な統計量の確認" id="基本的な統計量の確認">基本的な統計量の確認</a></h2>
<p>以下では、QGISでラスタデータが保持する情報を確認する手法を解説しています。</p>
<p><code>ラスタ＞その他＞ラスター情報</code>を開き、統計情報を表示するラスタを選択し、<code>画像統計量を読み込んで表示する</code>にチェックをつけ、実行をクリックする。
<img src="day3/pic/15pic_16.png" alt="基本統計量" /></p>
<p>実行結果は、結果ビューアの<code>File path</code>をクリックし、html形式で確認する（座標系、セルサイズ、最低標高、最高標高、平均標高、標高の標準偏差等）。
<img src="day3/pic/15pic_17.png" alt="基本統計量" /></p>
<p>ヒストグラムの表示は、<code>プロパティ＞ヒストグラム</code>を選択し、<code>ヒストグラムの計算</code>をクリックする。ヒストグラムは、左クリックすると拡大でき、右クリックで元のビューに戻る。
<img src="day3/pic/15pic_17-1.png" alt="基本統計量" /></p>
<p>※外れ値は、<code>プロパティ＞シンボロジー</code>の<code>最小/最大値設定</code>から、<code>累積数カット</code>等を指定し<code>適用</code>をクリックすることで、地図表現上、除外できる。</p>
<p><a href="day3/./15.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#ラスタ演算" id="ラスタ演算">ラスタ演算</a></h2>
<p>　セルの大きさや領域が同一のラスタデータは、演算によるデータ処理が可能です。ソフトウェアによっては、厳密にセルが重ならなくても補間した値で計算できるものもあります。この処理は、特定の条件に当てはまる地域の抽出や、2時期の地形の変化量の算出（例えば、10年前に取得された標高データと最近取得したデータを引き算する等）際などに用いられます。以下では、標高データや傾斜データを用いて、条件指定したエリアを抽出する手法について解説します。</p>
<p>はじめに、標高値と傾斜角のラスタを読み込む。<code>ラスタ＞ラスタ計算機</code>から計算結果を出力するための新規ラスタを作成する。
<img src="day3/pic/15pic_23.png" alt="ラスタ演算" /></p>
<p>DEMから標高450ｍ以上の地域を抽出する。
ラスタ計算式に<code>“aso_2kei@1” &gt;= 450</code>を入力後、OKをクリックすると右下の図のように表示される。
<img src="day3/pic/15pic_24.png" alt="ラスタ演算" /></p>
<p>DEMから標高300m以上で傾斜が5度以下の地域を抽出する。
ラスタ計算式に<code>“aso_2kei@1” &gt;= 450 AND “slope@1” &lt;= 5</code>を入力後、<code>OK</code>をクリックすると右下の図のように表示される。
※&quot;slope@&quot;1は[斜面方位図の作成]で作成した傾斜ラスタである。
<img src="day3/pic/15pic_25.png" alt="ラスタ演算" /></p>
<p><a href="day3/./15.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#流域解析" id="流域解析">流域解析</a></h2>
<p>　GISでは、DEMデータを利用して、河川やその流域を求めることができます。以下では、GRASS GISの機能を利用して、流域を抽出する手法を解説します。<strong>GRASS GISの機能を利用する際に、<code>アルゴリズム実行中にエラー</code>となる場合があるため、QGISを一度閉じ、QGIS Desktop 3.4.x with GRASS GIS 7.x.xを起動してください。</strong></p>
<p><code>プロセッシング＞ツールボックス</code>から<code>r.watershed</code>を選択する。
<img src="day3/pic/15pic_26.png" alt="流域解析" /></p>
<p><code>Elevation</code>に標高ラスタを指定し、流域とするセル数を10000とし、累積流量、流れの方向、河川、流域を抽出する。
<img src="day3/pic/15pic_27.png" alt="流域解析" /></p>
<p>各項目ごとに下のような図ができる。
<img src="day3/pic/15pic_28.png" alt="流域解析" /></p>
<p>以下から、流域と河川のラスタをベクトルに変換していく。河川は、ラインに出力できるように河川のラスタを単純化する。<code>プロセッシング＞ツールボックス</code>をクリックする。次に<code>r.thin</code>を検索し<code>r.thin</code>を選択する。河川のラスターを設定し実行をクリックする。
<img src="day3/pic/15pic_29.png" alt="流域解析" /></p>
<p>ラスタをベクトル（ライン）に変換し<code>プロセッシング＞ツールボックス</code>をクリックする。次に<code>r.to.vect</code>を選択する。Thinnedのラスタを指定し、feture typeでlineを選択する。出力のファイル名を一時ファイルへの保存として実行する。
<img src="day3/pic/15pic_30.png" alt="流域解析" /></p>
<p><code>プロパティ＞シンボロジー</code>を選択し、データのスタイルを調節する。
<img src="day3/pic/15pic_31.png" alt="流域解析" /></p>
<p>出力したデータを保存するため、河川の<code>プロパティ＞エクスポート＞地物の保存</code>を選択し、形式を<code>ESRI Shapefile</code>、出力場所とファイル名、CRSを指定し、<code>OK</code>をクリックする。
<img src="day3/pic/15pic_32.png" alt="流域解析" /></p>
<p>同様の手法で、流域ラスタを指定し、Feature type をareaとし、流域のポリゴンを出力する。
<img src="day3/pic/15pic_33.png" alt="流域解析" /></p>
<p><code>プロパティ＞シンボロジー＞分類された</code>からカラムをcatとし、<code>分類</code>をクリックする。データを保存するには、河川レイヤと同様に<code>プロパティ＞エクスポート＞地物の保存</code>を実行する。
<img src="day3/pic/15pic_34.png" alt="流域解析" /></p>
<p><a href="day3/./15.html#Menu">▲メニューへもどる</a></p>
<h4><a class="header" href="#この教材のa-hrefday3taskst_15html課題ページ_ラスタデータの分析aへ進む" id="この教材のa-hrefday3taskst_15html課題ページ_ラスタデータの分析aへ進む">この教材の<a href="day3/./tasks/t_15.html">課題ページ_ラスタデータの分析</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-8" id="ライセンスに関する注意事項-8">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day3/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題ラスタデータの分析" id="課題ラスタデータの分析">課題：ラスタデータの分析</a></h1>
<p>　この実習では、ラスタデータを用いた地形情報の可視化や分析を行います。ラスターデータはベクトルデータと異なり、ピクセルごとに入力された値が分析に用いられます。実習で使われる用語や概念は、地理情報科学教育用スライド（GIScスライド）の4章を参照してください。手順とGISオープン教材の<a href="day3/tasks/../../15/15.html">ラスタデータの分析</a>の教材を参考に、完成例のような地図が作成できれば、完了となります。</p>
<h3><a class="header" href="#実習用データ-7" id="実習用データ-7">実習用データ</a></h3>
<p>本実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/tasks/fuji_task_s.zip">Fuji_task</a>をダウンロードしてください。</p>
<h2><a class="header" href="#menu-11" id="menu-11"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day3/tasks/t_15.html#%E8%AA%B2%E9%A1%8C1_%E6%95%B0%E5%80%A4%E6%A8%99%E9%AB%98%E3%83%A2%E3%83%87%E3%83%AB%E3%81%AE%E8%A6%96%E8%A6%9A%E7%9A%84%E5%88%86%E6%9E%90">課題②_数値標高モデルの視覚的分析</a></li>
<li><a href="day3/tasks/t_15.html#%E8%AA%B2%E9%A1%8C2_%E6%B5%81%E5%9F%9F%E8%A7%A3%E6%9E%90">課題③_流域解析</a></li>
</ul>
<h2><a class="header" href="#課題②_数値標高モデルの視覚的分析" id="課題②_数値標高モデルの視覚的分析">課題②_数値標高モデルの視覚的分析</a></h2>
<p>　富士山周辺のDEMデータを用いて、標高区分図、傾斜区分図、傾斜方位図、陰影図、3D地図を作成し、レイアウトしてください。また、富士山の地形の特徴を整理し、300字程度でまとめてください。</p>
<h3><a class="header" href="#完成例-6" id="完成例-6">完成例</a></h3>
<p><img src="day3/tasks/pic/t15-1.png" alt="kadai" />
※　上段：左から、標高区分図（段彩図）、傾斜区分図、傾斜方位図、陰影図　下段：3D地図（背景地図として地理院タイルを使用）</p>
<h3><a class="header" href="#手順-8" id="手順-8">手順</a></h3>
<ol>
<li>ダウンロードしたラスターデータをQGISで読み、<a href="day3/tasks/../../10/10.html">空間データの統合・修正</a>の教材を参考にラスタデータを結合する。</li>
<li>ラスタ＞解析から傾斜、傾斜方位、陰影図を作成する。</li>
<li>標高値、傾斜角、斜面方位（0°-360°）など、それぞれのラスターデータの値に応じて色分けを行い、標高区分図、傾斜区分図、傾斜方位図を作成する。</li>
<li>平面では、確認しにくい箇所もあるため、3D地図を作成する。</li>
<li>作成した標高区分図、傾斜区分図、傾斜方位図、陰影図、3D地図を視覚的に分析し、富士山の地形的な特徴を簡単にまとめる。</li>
</ol>
<h2><a class="header" href="#課題③_流域解析" id="課題③_流域解析">課題③_流域解析</a></h2>
<p>　この課題ではDEMデータを用いた、流域解析を行います。以下の手順を参考に、完成例のような図を作成してください。</p>
<h3><a class="header" href="#完成例-7" id="完成例-7">完成例</a></h3>
<p><img src="day3/tasks/pic/t15-2.png" alt="kadai" /></p>
<h3><a class="header" href="#手順-9" id="手順-9">手順</a></h3>
<ol>
<li><a href="day3/tasks/../../15/15.html">ラスタデータの分析</a>教材を参考に、流域解析を選択し、流域の最小セルサイズを設定する(ここでは、3000とする)。</li>
<li>流域と河川のラスタをベクトルに変換する。</li>
<li>名前を付けて保存でベクトルレイヤとして保存する</li>
<li>地図をレイアウトする</li>
</ol>
<h4><a class="header" href="#実習用データのソース-6" id="実習用データのソース-6">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>
<h1><a class="header" href="#空間補間" id="空間補間">空間補間</a></h1>
<p>　本教材は、「空間補間」の実習用教材です。GISソフトウェアを用いた、空間補間の手法について解説しています。空間補間は、観測値などの既知のデータを用いて、周辺のデータを予測する際に用いる手法です。実際に処理をする場合は、値の分布状況や対象となるデータ特性を考慮した空間補間法の選定が重要になります。以下では、GISで不正三角網,逆距離加重法,スプライン,クリギングで空間補間する手法について、解説を行っています。本教材で扱う補間法の理論的な解説は、<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">地理情報科学教育用スライド（GIScスライド）</a>の4章が参考になります。</p>
<p>　課題形式で使用する場合は、本教材を一読した後、[課題ページ]へお進みください。本教材を使用する際は、<a href="day3/../../policy.html">利用規約</a>をご確認いただき、これらの条件に同意された場合にのみご利用下さい。</p>
<h2><a class="header" href="#menu-12" id="menu-12"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day3/18.html#%E4%B8%8D%E6%95%B4%E4%B8%89%E8%A7%92%E7%B6%B2">不整三角網</a></li>
<li><a href="day3/18.html#%E9%80%86%E8%B7%9D%E9%9B%A2%E5%8A%A0%E9%87%8D%E6%B3%95">逆距離加重法</a></li>
</ul>
<p>以下は余裕がある人のみ実習してください。</p>
<ul>
<li><a href="day3/18.html#%E3%82%B9%E3%83%97%E3%83%A9%E3%82%A4%E3%83%B3%E8%A3%9C%E9%96%93">スプライン補間</a></li>
<li><a href="day3/18.html#%E3%82%AF%E3%83%AA%E3%82%AE%E3%83%B3%E3%82%B0">クリギング</a></li>
</ul>
<p><strong>実習用データ</strong></p>
<p>実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/interpolation_s.zip">interpolation</a>をダウンロードしてください。</p>
<h2><a class="header" href="#不整三角網" id="不整三角網">不整三角網</a></h2>
<p>　以下では、ランダム抽出した富士山周辺の標高点を利用し、不整三角網（Triangulated lrregular Network）によって未観測の標高地点の値を補間する手法について解説します。ソフトウェアには、QGISを用います。</p>
<p>まず、elevation.shp, river.shp, fuji.tifをQGISに読み込む。<code>プロセッシング＞ツールボックス＞データ補間＞TIN補間</code>を選択し、以下の手順で実行する。
<img src="day3/pic/18pic_1.png" alt="Triangulation" /></p>
<ol>
<li>ベクタレイヤから標高点を指定する。</li>
<li>補間する属性をVALUEとする。</li>
<li>追加をクリックする。</li>
<li>タイプをポイントとする。同様にriverとその補完する属性として<code>h</code>を追加し、タイプをブレークラインとする。</li>
<li>領域から、レイヤの領域とする（標高点のレイヤを指定する）。</li>
<li>セルサイズのXYを30とする。</li>
<li>実行をクリックする。</li>
</ol>
<p>出力された結果を<code>プロパティ＞シンボロジー＞単バンド疑似カラー</code>で、最小を0、最大を1200とし、5段階の段彩表現とし、実際の標高データとの違いを確認する。余裕があれば、ブレークラインなしでの出力も行い結果の違いを確認する。
<img src="day3/pic/18pic_2.png" alt="Triangulation" /></p>
<p><a href="day3/./18.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#逆距離加重法" id="逆距離加重法">逆距離加重法</a></h2>
<p>以下では、逆距離加重法(IDW:Inverse Distance Weighted)で補間する手法について解説しています。</p>
<p><code>プロセッシング＞ツールボックス＞データ補間＞IDW補間</code>を選択し、以下の手順で実行する。
<img src="day3/pic/18pic_3.png" alt="IDW" /></p>
<ol>
<li>ベクタレイヤから標高点を指定する。</li>
<li>補間する属性をVALUEとする。</li>
<li>追加をクリックする。</li>
<li>タイプをポイントとする。同様にriverとその補完する属性として<code>h</code>を追加し、タイプをブレークラインとする。</li>
<li>領域から、レイヤの領域とする（標高点のレイヤを指定する）。</li>
<li>セルサイズのXYを30とする。</li>
<li>実行をクリックする。</li>
</ol>
<p>出力された結果を<code>プロパティ＞シンボロジー＞単バンド疑似カラー</code>で、最小を0、最大を1200とし、5段階の段彩表現とし、実際の標高データとの違いを確認する。余裕があれば、ブレークラインなしでの出力も行い結果の違いを確認する。
<img src="day3/pic/18pic_4.png" alt="IDW" /></p>
<p><a href="day3/./18.html#Menu">▲メニューへもどる</a></p>
<h2><a class="header" href="#以下は余裕がある人のみ実習してください" id="以下は余裕がある人のみ実習してください">以下は余裕がある人のみ実習してください。</a></h2>
<h3><a class="header" href="#スプライン補間" id="スプライン補間">スプライン補間</a></h3>
<p>以下では、スプライン補間として、QGISで利用できるSAGA GISのMultilevel b-splineの手法について解説しています。</p>
<p><code>プロセッシング＞ツールボックス</code>から<code>Multilevel b-spline interpolation</code>を選択し、以下の手順で実行する。
<img src="day3/pic/18pic_5.png" alt="spline" /></p>
<ol>
<li>Pointsに標高点を指定する。</li>
<li>Attribute をVALUEとする。</li>
<li>Cell sizeを30とする。</li>
<li>実行をクリックする。</li>
</ol>
<p>出力された結果を<code>プロパティ＞シンボロジー＞単バンド疑似カラー</code>で、最小を0、最大を1200とし、5段階の段彩表現とし、実際の標高データとの違いを確認する。
<img src="day3/pic/18pic_6.png" alt="spline" /></p>
<h3><a class="header" href="#クリギング" id="クリギング">クリギング</a></h3>
<p>　以下では、クリギングとして、QGISで利用できるSAGA GISのOrdinary Kriging(通常クリギング)の手法について解説しています。</p>
<p><code>プロセッシング＞ツールボックス</code>から<code>Ordinary kriging</code>を選択し、以下の手順で実行する。
<img src="day3/pic/18pic_7.png" alt="Kriging" /></p>
<ol>
<li>Pointsに標高点を指定する。</li>
<li>Attribute をVALUEとする。</li>
<li>Cell sizeを30とする。</li>
<li>最下段の’Quality Measure’のチェックをはずし、実行をクリックする。</li>
</ol>
<p>出力された結果を<code>プロパティ＞シンボロジー＞単バンド疑似カラー</code>で、最小を0、最大を1200とし、5段階の段彩表現とし、実際の標高データとの違いを確認する。
<img src="day3/pic/18pic_8.png" alt="Kriging" /></p>
<h4><a class="header" href="#この教材のa-hrefday3taskst_18html課題ページ_空間補間aへ進む" id="この教材のa-hrefday3taskst_18html課題ページ_空間補間aへ進む">この教材の<a href="day3/./tasks/t_18.html">課題ページ_空間補間</a>へ進む</a></h4>
<h4><a class="header" href="#ライセンスに関する注意事項-9" id="ライセンスに関する注意事項-9">ライセンスに関する注意事項</a></h4>
<p>本教材で利用しているキャプチャ画像の出典やクレジットについては、<a href="day3/../license.html">その他のライセンスについて</a>よりご確認ください。</p>
<h1><a class="header" href="#課題空間補間" id="課題空間補間">課題：空間補間</a></h1>
<p>　この実習では、標高値や地価のデータを用いて空間補間を行います。空間補間は、観測値などの既知のデータを用いて、周辺のデータを予測する際に用いる手法です。例えば、地価が高いA点と500ｍ離れている同じ地価のB点があると仮定した場合、中間のエリアも同じくらいの値になることが予想できます。実際に処理をする場合は、値の分布状況や対象となるデータ特性を考慮した空間補間法の選定が重要になります。この課題では、TIN（不整三角網）とIDW（逆距離加重法）による空間補間を行います。空間補間の概念や理論は、[地理情報科学教育用スライド（GIScスライド）]の4章を参照してください。以下の手順と<a href="day3/tasks/../../18/18.html">空間補間</a>の教材を参考に、完成例のような地図が作成できれば、完了となります。GIS初学者は、本教材を進める前に<a href="day3/tasks/../../00/00.html">GISの基本概念</a>の教材を確認しておいてください。</p>
<h3><a class="header" href="#実習用データ-8" id="実習用データ-8">実習用データ</a></h3>
<p>　実習をはじめる前に、<a href="https://github.com/gis-oer/datasets/raw/master/osaka_s.zip">osaka</a>をダウンロードしてください。</p>
<h2><a class="header" href="#menu-13" id="menu-13"><strong>Menu</strong></a></h2>
<ul>
<li><a href="day3/tasks/t_18.html#%E8%AA%B2%E9%A1%8C1_%E4%B8%8D%E6%95%B4%E4%B8%89%E8%A7%92%E7%B6%B2">課題④_不整三角網</a></li>
<li><a href="day3/tasks/t_18.html#%E8%AA%B2%E9%A1%8C2_%E9%80%86%E8%B7%9D%E9%9B%A2%E5%8A%A0%E9%87%8D%E6%B3%95">課題⑤_逆距離加重法</a></li>
</ul>
<hr />
<h2><a class="header" href="#課題1_不整三角網" id="課題1_不整三角網">課題1_不整三角網</a></h2>
<p>　この実習は、標高点データを不整三角網で空間補間を行うものです。不整三角網は、近くの点を結び三角形で領域を分割し、角三角形ごとに値を補間する手法です。詳しくは<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">講義用教材（8.　空間補間）</a>の教材を参照してください。<a href="day3/tasks/../../18/18.html">空間補間</a>の教材を参考に、大阪市の標高値を空間補間し、等高線を抽出した地図を作成して下さい。</p>
<h3><a class="header" href="#手順-10" id="手順-10">手順</a></h3>
<ol>
<li>新たにQGISを立ち上げ、課題データを読み込む。</li>
<li>プロセッシングツールから、標高値を不整三角網法(TIN)を実行する。</li>
<li>補間したラスタを利用し、10m間隔の等高線を作成する。</li>
<li>地図をレイアウトする。</li>
</ol>
<h2><a class="header" href="#課題2_逆距離加重法" id="課題2_逆距離加重法">課題2_逆距離加重法</a></h2>
<p>　この実習は、地価データを逆距離加重法(IDW)で空間補間を行うものです。IDW（逆距離加重法）は、補間点から観測点までの距離（観測点までの距離の逆数）で重み付けを行い補間する手法です。詳しくは<a href="http://curricula.csis.u-tokyo.ac.jp/slide/4.html">講義用教材（8.　空間補間）</a>の教材を参照してください。<a href="day3/tasks/../../18/18.html">空間補間</a>の教材を参考に、大阪市の地価データを空間補間した地図を作成して下さい。</p>
<h3><a class="header" href="#手順-11" id="手順-11">手順</a></h3>
<ol>
<li>新たにQGISを立ち上げ、データを読み込む。</li>
<li>プロセッシングツールから、地価公示をIDWで補間する。</li>
<li>補間したデータを確認し、地図をレイアウトする。</li>
</ol>
<h4><a class="header" href="#実習用データのソース-7" id="実習用データのソース-7">実習用データのソース</a></h4>
<p>実習用データは、無償で利用可能なデータを加工して作成したものです。データのソースは、各ファイルのREADME.mdにまとめています。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
